---
title: 'Techniques Quentitatives de Gestion : exploitation des données (3)'
author: Ludovic Vigneron
date: '2022-09-22'
slug: []
categories:
  - Cours
  - R
tags:
  - Cours
  - Exercice
  - R
---



<p><strong>Après le test de différence de moyennes, nous attaquons dans cette session à la régression linéaire simple. Celle-ci permet d’établir le degré d’association entre une variable expliquée (<span class="math inline">\(y_i\)</span>) et une variable explicative (<span class="math inline">\(x_i\)</span>). La relation mesurée est matérialisée par une équation linéaire à un facteur (celle d’une droite). On a ainsi : <span class="math inline">\(y_i=\alpha+\beta.x_i\)</span>. Cette approche se distingue du simple coefficient de corrélation dans la mesure où elle implique notamment un sens à la relation. L’évolution de la variable explicative génère l’évolution de la variable expliquée.</strong></p>
<p>L’ensemble est établi au travers des moindres carrés ordinaires (MCO). R propose une fonction simple pour réaliser l’ajustement: <strong>lm()</strong>. Elle prend comme premier argument l’équation de régression (variable expliquée ~ variable explicative) et comme second (data) le nom de la data frame dans laquelles sont stockées les données (à défaut il faudra indiquer nom_data_frame$ pour le nom de chaque variable dans l’équation). Mais voyons tous ça au travers d’une série d’application.</p>
<div id="tâche-n1-mesurez-au-travers-dune-regression-linéaire-simple-le-degré-dassociation-entre-le-résultat-au-test-et-le-ratio-enseignésenseignant" class="section level1">
<h1>Tâche n°1 Mesurez au travers d’une regression linéaire simple le degré d’association entre le résultat au test et le ratio enseignés/enseignant</h1>
<p>Il s’agit pour nous d’estimer un modèle linéaire sur les données des écoles californiennes pour obtenir approximation de la relation testscr str. Celle-ci prendra la forme:</p>
<p><span class="math display">\[testscr_i=\hat{\alpha}+\hat{\beta}.str_i+\epsilon_i\]</span></p>
<p>Commençons par charger les packages habituels.</p>
<pre class="r"><code>library(tidyverse)
library(haven)
library(gt)</code></pre>
<p>Puis, importons les données dans R. Si vous ne les avez pas encore dans votre dossier de travail, je vous renvoie aux deux postes précédents (ici et là).</p>
<pre class="r"><code>caschool &lt;- read_dta(&quot;caschool.dta&quot;)</code></pre>
<p>Limitons la base aux seules données utiles str et testscr.</p>
<pre class="r"><code>variables &lt;- caschool %&gt;% select(str,testscr)</code></pre>
<p>Ceci fait avant d’estimer notre modèle traçons le nuage de points correspondant à l’intersection de nos deux variables. Pour cela, utilisons <strong>ggplot()</strong> une fonction <em>du tidyerse</em>. Indiquons la data frame dans laquelle les données sont stockées, les variables utilisées en abscisse et un ordonné. Ajoutons avec geom_point() que nous voulons un nuage de points (pour ceux qui voudraient en savoir plus sur ggplot vous trouverez <a href="https://myecontricks.netlify.app/categories/datavisualisation/">ici</a> une série de posts portant sur son utilisation)</p>
<pre class="r"><code>ggplot(data=variables,aes(x=str,y=testscr))+
  geom_point()</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>La forme du nuage nous laisse penser qu’il y aurait une relation négative entre les variables. Il semble qu’en moyenne, plus str est important, moins testscr l’est.</p>
<p>Réalisons le régression pour voir si on a bin un beta négatif.</p>
<pre class="r"><code>lm(testscr~str,data=variables)</code></pre>
<pre><code>## 
## Call:
## lm(formula = testscr ~ str, data = variables)
## 
## Coefficients:
## (Intercept)          str  
##      698.93        -2.28</code></pre>
<p>C’est le cas. Voyons ce que cela donne graphiquement en ajoutant à notre précédent graphe une droite reprenant la valeur de paramètres estimées. Pour cela, utilisons le <strong>geom_abline()</strong>.</p>
<pre class="r"><code>ggplot(data=variables,aes(x=str,y=testscr))+
  geom_point()+
  geom_abline(intercept = 698.93,slope = -2.28, color=&#39;red&#39;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Voyons si la relation mise au jour apparaît statistiquement significatif. Nous testerons l’hypothèse H0 que le coefficient beta égale à 0 contre H1 beta est différent de 0. Pour cela, le plus simple est d’utiliser la fonction <strong>summary()</strong> sur notre modèle de régression.</p>
<pre class="r"><code>lm(testscr~str,data=variables) %&gt;% summary()</code></pre>
<pre><code>## 
## Call:
## lm(formula = testscr ~ str, data = variables)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -47.727 -14.251   0.483  12.822  48.540 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 698.9330     9.4675  73.825  &lt; 2e-16 ***
## str          -2.2798     0.4798  -4.751 2.78e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 18.58 on 418 degrees of freedom
## Multiple R-squared:  0.05124,    Adjusted R-squared:  0.04897 
## F-statistic: 22.58 on 1 and 418 DF,  p-value: 2.783e-06</code></pre>
<p>Nous obtenons toute une série de nouvelles informations notamment des tests statistiques sur les paramètres du modèle individuellement (les tests de Student) ou globalement (le test de Fisher sur le dernière ligne). Ici, l’ensemble rejet les hypothèses H0 associées. Si on prend le beta de str, on a pour le test (de Student H0 beta = 0) pratiqué produit une p-value trés trés petite (bien inférieur à 1% 0.01). Cela permet très largement de rejeter l’hypothèse H0. Le coefficient est bien statistiquement différent à 0.</p>
<p>Interprétons rapidement la relation mis en évidence. Tout d’abord, on peut dire si str tend vers 0 alors le score du test tend vers l’ordonnée à l’origine de la droite, le coefficient alpha (la constante du modèle), c’est à dire ici 698.93. Si str = 1, on a <span class="math inline">\(698.93-2.27/times{1}=696.6\)</span>…</p>
<p>On peut obtenir les prédictions du modèle pour différentes valeurs très facilement en utilisant la fonction <strong>predict()</strong>. Elle prend comme premier argument le modèle et comme second les valeurs de la variable explicatives pour lesquels vous voulez réaliser la prédiction (dans une data frame). Choisisons 0, 1 , 2 ainsi la moyenne de str et sa médiane.</p>
<pre class="r"><code>lm(testscr~str,data=variables) %&gt;% 
  predict(data.frame(str=c(0,1,2,19.64,19.72))) %&gt;% 
  data.frame(str=c(0,1,2,19.64,19.72),prediction=.) %&gt;%
  `rownames&lt;-`( NULL )</code></pre>
<pre><code>##     str prediction
## 1  0.00   698.9330
## 2  1.00   696.6531
## 3  2.00   694.3733
## 4 19.64   654.1575
## 5 19.72   653.9751</code></pre>
</div>
<div id="tâche-n2-estimez-le-beta-issu-du-modèle-de-marché-pour-les-actions-microsoft-apple-et-facebook-meta" class="section level1">
<h1>Tâche n°2: Estimez le Beta issu du modèle de marché pour les actions Microsoft, Apple et Facebook (Meta)</h1>
<p>La première étape de ce travail consiste à obtenir les données de associé aux cours des actions et de l’indice de marché (ici le S&amp;P500). Pour cela, nous allons utiliser le package <em>quantmod</em> qui propose toute une série de fonction dédiée à des applications de finance de marché.</p>
<pre class="r"><code>library(quantmod)</code></pre>
<p>La fonction qui nous intéressera ici est <strong>getSymbols()</strong> qui permet d’obtenir les informations de cours désirées à partir d’un liste de ticker. Ces codes peuvent être retrouvé assez facilement à partir d’une recherche internet. On a ainsi pour Microsoft MSFT, pour Apple AAPL, pour Facebook Meta et pour l’indice S&amp;P500 ^GSPC. Indiquons le site d’extraction yahoo finance ainsi que la période sur laquelle les données doivent courir.</p>
<pre class="r"><code>getSymbols(c(&#39;MSFT&#39;,&#39;AAPL&#39;,&#39;Meta&#39;,&#39;^GSPC&#39;),src=&#39;yahoo&#39;,
           from=&quot;2016-01-01&quot;,to=&quot;2016-12-31&quot;)</code></pre>
<pre><code>## [1] &quot;MSFT&quot;  &quot;AAPL&quot;  &quot;Meta&quot;  &quot;^GSPC&quot;</code></pre>
<p>L’extraction produit un objet par ticker. Les données sont présentées au format xts qui est spécifique aux séries temporelles. Pour la suite, il est plus simple de les réunir au sein d’une seule data frame classique. Pour chaque ticker, nous établissons une data frame avec une variable date reprenant ce qui était indiqué en nom de ligne dans le xts. Puis, nous fusionnons l’ensemble avec <strong>left_join()</strong> et suprimons de l’environnement de travail les objets inutils.</p>
<pre class="r"><code>t1&lt;-MSFT %&gt;% data.frame %&gt;% data.frame(Date = rownames(.), .) %&gt;% 
  mutate(date=as.Date(Date)) 
t2&lt;-AAPL %&gt;% data.frame %&gt;% data.frame(Date = rownames(.), .) %&gt;% 
  mutate(date=as.Date(Date))
t3&lt;-GSPC %&gt;% data.frame %&gt;% data.frame(Date = rownames(.), .) %&gt;% 
  mutate(date=as.Date(Date))
t4&lt;-META %&gt;% data.frame %&gt;% data.frame(Date = rownames(.), .) %&gt;% 
  mutate(date=as.Date(Date))
dat&lt;-left_join(t1,t2) %&gt;% left_join(.,t3) %&gt;% left_join(.,t4)</code></pre>
<pre><code>## Joining, by = c(&quot;Date&quot;, &quot;date&quot;)
## Joining, by = c(&quot;Date&quot;, &quot;date&quot;)
## Joining, by = c(&quot;Date&quot;, &quot;date&quot;)</code></pre>
<pre class="r"><code>rm(t1,t2,t3,t4,MSFT,AAPL,META,GSPC)</code></pre>
<p>Limitons l’information aux seuls cours de clôture ajustés (ticker.adjusted).</p>
<pre class="r"><code>dat&lt;-dat %&gt;% select(Date,MSFT.Adjusted,AAPL.Adjusted,
                    META.Adjusted,GSPC.Adjusted)</code></pre>
<p>Calculons les rendements journaliers (jours de cotation) simples correspondant aux différentes séries.</p>
<p><span class="math display">\[ rend=\frac{prix_t}{prix_{t-1}}-1\]</span></p>
<pre class="r"><code>dat&lt;-dat %&gt;% mutate(ret_MSFT=MSFT.Adjusted/lag(MSFT.Adjusted)-1,
                    ret_AAPL=AAPL.Adjusted/lag(AAPL.Adjusted)-1,
                    ret_META=META.Adjusted/lag(META.Adjusted)-1,
                    ret_GSPC=GSPC.Adjusted/lag(GSPC.Adjusted)-1)</code></pre>
<p>Avant d’aller plus loin sauvegardons des données dans un fichier .csv. Pour cela, il nous suffit d’utiliser la fonction <strong>write.table()</strong>.</p>
<pre class="r"><code>write.table(dat,file=&quot;return_actions.csv&quot;,row.names = FALSE,sep=&#39;;&#39;)</code></pre>
<p>A partir de là, on peut régresser le rendement de chaque titre sur le rendement du marché pour obtenir le Beta du modèle de marché. Pour cela, nous utilisons le fonction <strong>lm()</strong> et générons les statistiques de présentation du résultat grâce à la fonction <strong>summary()</strong> associée.</p>
<pre class="r"><code>reg1&lt;-summary(lm(ret_MSFT~ret_GSPC,data=dat))
reg1</code></pre>
<pre><code>## 
## Call:
## lm(formula = ret_MSFT ~ ret_GSPC, data = dat)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.071914 -0.004895  0.000246  0.005083  0.047691 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.0001444  0.0006381   0.226    0.821    
## ret_GSPC    1.2368715  0.0778015  15.898   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.01009 on 249 degrees of freedom
##   (1 observation effacée parce que manquante)
## Multiple R-squared:  0.5037, Adjusted R-squared:  0.5017 
## F-statistic: 252.7 on 1 and 249 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Le beta correspond au coefficient associé aux rendements du titre. Pour Microsoft, il est de 1,23 et il est statistiquement significative. Le titre amplifie les mouvements de marché.</p>
<pre class="r"><code>reg2&lt;-summary(lm(ret_AAPL~ret_GSPC,data=dat))
reg2</code></pre>
<pre><code>## 
## Call:
## lm(formula = ret_AAPL ~ ret_GSPC, data = dat)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.064371 -0.005698 -0.000121  0.005559  0.066086 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.0001047  0.0007666   0.137    0.891    
## ret_GSPC    1.0237048  0.0934627  10.953   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.01213 on 249 degrees of freedom
##   (1 observation effacée parce que manquante)
## Multiple R-squared:  0.3251, Adjusted R-squared:  0.3224 
## F-statistic:   120 on 1 and 249 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Pour Apple, il est de 1,02 et il est statistiquement significative. Le titre suit simplement les mouvements de marché.</p>
<pre class="r"><code>reg3&lt;-summary(lm(ret_META~ret_GSPC,data=dat))
reg3</code></pre>
<pre><code>## 
## Call:
## lm(formula = ret_META ~ ret_GSPC, data = dat)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.051670 -0.006175 -0.000512  0.005760  0.149045 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.0001248  0.0009768   0.128    0.898    
## ret_GSPC    1.0933911  0.1190926   9.181   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.01545 on 249 degrees of freedom
##   (1 observation effacée parce que manquante)
## Multiple R-squared:  0.2529, Adjusted R-squared:  0.2499 
## F-statistic: 84.29 on 1 and 249 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Pour Facebook, il est de 1,09 et il est statistiquement significative. Le titre suit les mouvements de marché.</p>
<p>Réunissons le tout dans un tableau unique. Etablissons une data frame incluant les betas, les t stat associé et les p-values.</p>
<pre class="r"><code>tab&lt;-data.frame(c(&#39;Microsoft&#39;,&#39;Apple&#39;,&#39;Facebook&#39;),
                rbind(round(reg1$coefficients[2,c(1,3,4)],digits=4),
                      round(reg2$coefficients[2,c(1,3,4)],digits=4),
                      round(reg3$coefficients[2,c(1,3,4)],digits=4))) 
colnames(tab)&lt;-c(&#39; &#39;,&#39;Beta&#39;,&#39;t stat&#39;, &#39;p value&#39;)
tab$`p value`&lt;-format(tab$`p value`,nsmall = 4)
tab</code></pre>
<pre><code>##               Beta  t stat p value
## 1 Microsoft 1.2369 15.8978  0.0000
## 2     Apple 1.0237 10.9531  0.0000
## 3  Facebook 1.0934  9.1810  0.0000</code></pre>
<p>Mettons le résultat sous la forme d’un tableau (<strong>gt()</strong>) et mettons l’ensemble en page.</p>
<pre class="r"><code>tab_&lt;-gt(tab) %&gt;% 
  tab_header(title=&#39;Beta issu du modèle de marché&#39;,
             subtitle = &quot;Estimé sur 2016 en référence à l&#39;indice S&amp;P500&quot;)
tab_</code></pre>
<div id="rymxyklqsi" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#rymxyklqsi .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rymxyklqsi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rymxyklqsi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rymxyklqsi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rymxyklqsi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rymxyklqsi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rymxyklqsi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rymxyklqsi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rymxyklqsi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rymxyklqsi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rymxyklqsi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rymxyklqsi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#rymxyklqsi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rymxyklqsi .gt_from_md > :first-child {
  margin-top: 0;
}

#rymxyklqsi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rymxyklqsi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rymxyklqsi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rymxyklqsi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rymxyklqsi .gt_row_group_first td {
  border-top-width: 2px;
}

#rymxyklqsi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rymxyklqsi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rymxyklqsi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rymxyklqsi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rymxyklqsi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rymxyklqsi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rymxyklqsi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rymxyklqsi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rymxyklqsi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rymxyklqsi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rymxyklqsi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rymxyklqsi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rymxyklqsi .gt_left {
  text-align: left;
}

#rymxyklqsi .gt_center {
  text-align: center;
}

#rymxyklqsi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rymxyklqsi .gt_font_normal {
  font-weight: normal;
}

#rymxyklqsi .gt_font_bold {
  font-weight: bold;
}

#rymxyklqsi .gt_font_italic {
  font-style: italic;
}

#rymxyklqsi .gt_super {
  font-size: 65%;
}

#rymxyklqsi .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#rymxyklqsi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rymxyklqsi .gt_indent_1 {
  text-indent: 5px;
}

#rymxyklqsi .gt_indent_2 {
  text-indent: 10px;
}

#rymxyklqsi .gt_indent_3 {
  text-indent: 15px;
}

#rymxyklqsi .gt_indent_4 {
  text-indent: 20px;
}

#rymxyklqsi .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  <thead class="gt_header">
    <tr>
      <td colspan="4" class="gt_heading gt_title gt_font_normal" style>Beta issu du modèle de marché</td>
    </tr>
    <tr>
      <td colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Estimé sur 2016 en référence à l'indice S&amp;P500</td>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col"> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Beta</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">t stat</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">p value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Microsoft</td>
<td class="gt_row gt_right">1.2369</td>
<td class="gt_row gt_right">15.8978</td>
<td class="gt_row gt_right">0.0000</td></tr>
    <tr><td class="gt_row gt_left">Apple</td>
<td class="gt_row gt_right">1.0237</td>
<td class="gt_row gt_right">10.9531</td>
<td class="gt_row gt_right">0.0000</td></tr>
    <tr><td class="gt_row gt_left">Facebook</td>
<td class="gt_row gt_right">1.0934</td>
<td class="gt_row gt_right">9.1810</td>
<td class="gt_row gt_right">0.0000</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Importons le résultat dans Word via <strong>gtsave()</strong>.</p>
<pre class="r"><code>gtsave(tab_,&#39;Betas_v1.docx&#39;)</code></pre>
</div>

---
title: 'Techniques Quantitatives de Gestion : exploitation des données (7)'
author: Ludovic Vigneron
date: '2022-11-28'
slug: []
categories:
  - Cours
  - TQG
  - R
tags:
  - Cours
  - Exercice
  - r
  - TQG
---



<p><strong>Pour ce dernier poste de la série, l’idée est d’abordé rapidement les traitements de variables continuent qui s’éloignent d’une loi normale. Nous traiterons rapidement de la transformation logarithmique et la winsorisation. L’exemple pris n’est pas le plus pertinent (deux des trois variables suivent vraisemblablement des lois normales), mais les étudiants ont déjà utilisé ces données. J’en profites pour montrer comment on crée des fonctions permettant d’aller plus vite dans les traitements avec la création d’histogrammes et de tableaux de présentation des résultats de régression.</strong></p>
<p>Comme à chaque fois, commençons par charger les packages que nous allons utiliser.</p>
<pre class="r"><code>library(tidyverse)
library(scales)
library(patchwork)
library(haven)
library(moments)
library(lmtest)
library(sandwich)
library(broom)
library(DescTools)
library(gt)</code></pre>
<p>Chargeons les données sur lesquelles nous allons travailler. Utilisons une nouvelle fois l’étude sur les écoles californiennes.</p>
<pre class="r"><code>dat&lt;-read_dta(&quot;caschool.dta&quot;)</code></pre>
<p>Limitons notre attention sur l’explication des résultats au teste des niveau (testscr) par le nombre d’élèves par professeur (str) et le pourcentage d’élèves dont l’anglais n’est pas la langue natale (el_pct). Mais avant d’aller plus loin, voyons quelques statistiques descriptives.</p>
<div id="wylslaqitt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#wylslaqitt .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wylslaqitt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wylslaqitt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wylslaqitt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wylslaqitt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wylslaqitt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wylslaqitt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wylslaqitt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wylslaqitt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wylslaqitt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wylslaqitt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wylslaqitt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wylslaqitt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wylslaqitt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wylslaqitt .gt_from_md > :first-child {
  margin-top: 0;
}

#wylslaqitt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wylslaqitt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wylslaqitt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wylslaqitt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wylslaqitt .gt_row_group_first td {
  border-top-width: 2px;
}

#wylslaqitt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wylslaqitt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wylslaqitt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wylslaqitt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wylslaqitt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wylslaqitt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wylslaqitt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wylslaqitt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wylslaqitt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wylslaqitt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wylslaqitt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wylslaqitt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wylslaqitt .gt_left {
  text-align: left;
}

#wylslaqitt .gt_center {
  text-align: center;
}

#wylslaqitt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wylslaqitt .gt_font_normal {
  font-weight: normal;
}

#wylslaqitt .gt_font_bold {
  font-weight: bold;
}

#wylslaqitt .gt_font_italic {
  font-style: italic;
}

#wylslaqitt .gt_super {
  font-size: 65%;
}

#wylslaqitt .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#wylslaqitt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wylslaqitt .gt_indent_1 {
  text-indent: 5px;
}

#wylslaqitt .gt_indent_2 {
  text-indent: 10px;
}

#wylslaqitt .gt_indent_3 {
  text-indent: 15px;
}

#wylslaqitt .gt_indent_4 {
  text-indent: 20px;
}

#wylslaqitt .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  <thead class="gt_header">
    <tr>
      <td colspan="12" class="gt_heading gt_title gt_font_normal gt_bottom_border" style></td>
    </tr>
    
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id=" "> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Average">Average</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Std. Dev.">Std. Dev.</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Skewness">Skewness</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Kurtosis">Kurtosis</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="7" scope="colgroup" id="Percentiles">
        <span class="gt_column_spanner">Percentiles</span>
      </th>
    </tr>
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="10%">10%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="25%">25%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="40%">40%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="50%">50%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="60%">60%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="75%">75%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="90%">90%</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="" class="gt_row gt_left">score</td>
<td headers="Average" class="gt_row gt_right">654.16</td>
<td headers="Std. Dev." class="gt_row gt_right">19.05</td>
<td headers="Skewness" class="gt_row gt_right">0.09</td>
<td headers="Kurtosis" class="gt_row gt_right">2.75</td>
<td headers="10%" class="gt_row gt_right">630.40</td>
<td headers="25%" class="gt_row gt_right">640.05</td>
<td headers="40%" class="gt_row gt_right">649.07</td>
<td headers="50%" class="gt_row gt_right">654.45</td>
<td headers="60%" class="gt_row gt_right">659.40</td>
<td headers="75%" class="gt_row gt_right">666.66</td>
<td headers="90%" class="gt_row gt_right">678.86</td></tr>
    <tr><td headers="" class="gt_row gt_left">taux d'encadrement</td>
<td headers="Average" class="gt_row gt_right">19.64</td>
<td headers="Std. Dev." class="gt_row gt_right">1.89</td>
<td headers="Skewness" class="gt_row gt_right">-0.03</td>
<td headers="Kurtosis" class="gt_row gt_right">3.61</td>
<td headers="10%" class="gt_row gt_right">17.35</td>
<td headers="25%" class="gt_row gt_right">18.58</td>
<td headers="40%" class="gt_row gt_right">19.27</td>
<td headers="50%" class="gt_row gt_right">19.72</td>
<td headers="60%" class="gt_row gt_right">20.08</td>
<td headers="75%" class="gt_row gt_right">20.87</td>
<td headers="90%" class="gt_row gt_right">21.87</td></tr>
    <tr><td headers="" class="gt_row gt_left">% de non angl</td>
<td headers="Average" class="gt_row gt_right">15.77</td>
<td headers="Std. Dev." class="gt_row gt_right">18.29</td>
<td headers="Skewness" class="gt_row gt_right">1.43</td>
<td headers="Kurtosis" class="gt_row gt_right">4.44</td>
<td headers="10%" class="gt_row gt_right">0.00</td>
<td headers="25%" class="gt_row gt_right">1.94</td>
<td headers="40%" class="gt_row gt_right">5.01</td>
<td headers="50%" class="gt_row gt_right">8.78</td>
<td headers="60%" class="gt_row gt_right">13.14</td>
<td headers="75%" class="gt_row gt_right">22.97</td>
<td headers="90%" class="gt_row gt_right">43.78</td></tr>
  </tbody>
  
  
</table>
</div>
<p>La Kurtosis d’une distribution normale est 3. Au dessus de 3, la distribution est moins aplatie qu’une loi normale. En dessous de 3, la distribution est plus aplatie. La Skewness d’une distribution normale est 0. Au dessus de 0, la distribution est asymétrique sur la gauche. En dessous de 0, la distribution est asymétrique sur la droite.</p>
<p>Ici, on voit que l’on est pas très éloignés de la loi normale concernant la Kurtosis et la Skewness pour les testes de niveau (testscr) et le taux d’encadrement (str), mais que ce n’est pas le cas pour le pourcentage d’élève dont l’anglais n’est pas la première langue (el_pct).</p>
<p>Observons cela au travers d’histogrammes sur lesquels les lois normales correspondant aux données sont projetées. Pour éviter des réplication de codes trop long par la suite, créons une fonction.</p>
<pre class="r"><code>hist_dist_&lt;-function(var1,df,nom){
  attach(df)
  x&lt;-var1
  detach()
  ggplot(data = df,aes(x=x))+
  geom_histogram(aes(y =after_stat(density)),bins=30,
                 fill=&#39;grey&#39;,color=&#39;black&#39;)+
  geom_vline(xintercept = mean(x) ,color=&#39;red&#39;)+
  stat_function(fun = dnorm, 
                args = list(mean = mean(x), sd = sd(x)))+
  labs(x=nom)+
  #scale_y_continuous(labels = label_percent())+
  theme_minimal()}</code></pre>
<p>Ceci fait, présentons les graphes de nos trois variables.</p>
<pre class="r"><code>G1&lt;-hist_dist_(var1 = testscr,df=dat,nom=&quot;score&quot;)
G2&lt;-hist_dist_(var1 = str,df=dat,nom=&quot;taux d&#39;encadrement&quot;)
G3&lt;-hist_dist_(var1 = el_pct,df=dat,nom=&quot;% de non angl&quot;)
G1/(G2+G3)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Évaluons le modèle linéaire expliquant les résultats du teste par le taux d’encadrement et le pourcentage de non anglophone. Utilisons une estimation robuste à l’hétéroscédasticité des tests sur les coefficients.</p>
<p>Comme nous allons estimé plusieurs fois le modèle est qu’à chaque fois nous souhaitons avoir un tableau de résultat élégant, créons comme une fonction permettant de les répliquer plus facilement.</p>
<pre class="r"><code>reg_&lt;-function(model,don,lab,opt=&quot;lign&quot;){
  reg&lt;-lm(model,data=don)
  reg_t&lt;-tidy(coeftest(reg,vcov=vcovHC(reg,&#39;HC0&#39;))) %&gt;% 
    mutate(term=c(lab),
           estimate=round(estimate,digits=3),
           std.error=round(std.error,digits=3),
           statistic=round(statistic,digits=3),
           p.value=round(p.value,digits=3),
           star=ifelse(p.value&lt;=0.01,&#39;***&#39;,
                ifelse(p.value&gt;0.01|p.value&lt;=0.05,&#39;**&#39;,
                ifelse(p.value&gt;0.05|p.value&lt;=0.1,&#39;*&#39;,&#39; &#39;))))
  gl&lt;-glance(reg)
  qa&lt;-round(gl$adj.r.squared,digits=4)
  fish&lt;-round(gl$statistic,digits=2)
  df&lt;-gl$nobs
  eto&lt;-ifelse(gl$p.value&lt;=0.01,&#39;***&#39;,
                ifelse(gl$p.value&gt;0.01|gl$p.value&lt;=0.05,&#39;**&#39;,
                ifelse(gl$p.value&gt;0.05|gl$p.value&lt;=0.1,&#39;*&#39;,&#39; &#39;)))
  if (opt==&quot;lign&quot;) {
    R2&lt;-c(&#39;Adj_R2&#39;,qa,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;)
    fisher&lt;-c(&#39;F de fisher&#39;,fish,eto,&#39;&#39;,&#39;&#39;,&#39;&#39;)
    nb&lt;-c(&#39;nobs&#39;,df,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;)
    reg_t&lt;-rbind(reg_t,R2,fisher,nb)
    return(reg_t)}
  if (opt==&quot;col_sd&quot;){
    ff&lt;-c();mod&lt;-c();st&lt;-c()
      for (i in 1:length(lab)){
        f&lt;-rbind(reg_t[i,1],&#39;&#39;)
        g&lt;-rbind(reg_t$estimate[i],
                 paste(&#39;(&#39;,reg_t$std.error[i],&#39;)&#39;))
        s&lt;-rbind(reg_t$star[i],&#39;&#39;)
        ff&lt;-rbind(ff,f)
        mod&lt;-rbind(mod,g)
        st&lt;-rbind(st,s)}
    tb&lt;-tibble(ff,mod,&#39; &#39;=st)
    R2&lt;-c(&#39;Adj_R2&#39;,qa,&#39;&#39;)
    fisher&lt;-c(&#39;F de fisher&#39;,fish,eto)
    nb&lt;-c(&#39;nobs&#39;,df,&#39;&#39;)
    tb&lt;-rbind(tb,R2,fisher,nb)}
  return(tb)}</code></pre>
<p>La fonction prévoit deux types de sortie que l’on peut appeler par l’option opt. La première ‘lign’, qui est celle donné par défaut, présente les coefficient, l’erreur standard, les t stat, les p-value et les étoiles d’interprétation.</p>
<pre class="r"><code>r1&lt;-reg_(testscr~str+el_pct,don=dat,
     lab=c(&#39;constante&#39;,&quot;taux d&#39;encadrement&quot;,&#39;% de non angl&#39;))</code></pre>
<p>Créons une fonction pour la mise en forme de ce type de tableau à partir du package <em>gt</em>.</p>
<pre class="r"><code>mis_lign&lt;-function(t){
  gt(t) %&gt;% 
  tab_style(style=list(cell_fill(color = &quot;#F9E3D6&quot;),
                       cell_text(style = &quot;italic&quot;)),
            locations = cells_body(columns = c(2:6),
                                   rows=c(1:3)))%&gt;% 
  tab_style(style = cell_borders(sides = &quot;bottom&quot;,color = &quot;black&quot;,
                                 weight = px(2),style = &quot;solid&quot;),
            locations = cells_body(columns = everything(),
                                   rows = c(3,6)))}</code></pre>
<p>Voyons ce que cela donne.</p>
<pre class="r"><code>mis_lign(r1)</code></pre>
<div id="oqydzxzpml" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#oqydzxzpml .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oqydzxzpml .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oqydzxzpml .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oqydzxzpml .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oqydzxzpml .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oqydzxzpml .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oqydzxzpml .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oqydzxzpml .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oqydzxzpml .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oqydzxzpml .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oqydzxzpml .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oqydzxzpml .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oqydzxzpml .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oqydzxzpml .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oqydzxzpml .gt_from_md > :first-child {
  margin-top: 0;
}

#oqydzxzpml .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oqydzxzpml .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oqydzxzpml .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#oqydzxzpml .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oqydzxzpml .gt_row_group_first td {
  border-top-width: 2px;
}

#oqydzxzpml .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oqydzxzpml .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oqydzxzpml .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oqydzxzpml .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oqydzxzpml .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oqydzxzpml .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oqydzxzpml .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oqydzxzpml .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oqydzxzpml .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oqydzxzpml .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oqydzxzpml .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oqydzxzpml .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oqydzxzpml .gt_left {
  text-align: left;
}

#oqydzxzpml .gt_center {
  text-align: center;
}

#oqydzxzpml .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oqydzxzpml .gt_font_normal {
  font-weight: normal;
}

#oqydzxzpml .gt_font_bold {
  font-weight: bold;
}

#oqydzxzpml .gt_font_italic {
  font-style: italic;
}

#oqydzxzpml .gt_super {
  font-size: 65%;
}

#oqydzxzpml .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#oqydzxzpml .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oqydzxzpml .gt_indent_1 {
  text-indent: 5px;
}

#oqydzxzpml .gt_indent_2 {
  text-indent: 10px;
}

#oqydzxzpml .gt_indent_3 {
  text-indent: 15px;
}

#oqydzxzpml .gt_indent_4 {
  text-indent: 20px;
}

#oqydzxzpml .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="star">star</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">constante</td>
<td headers="estimate" class="gt_row gt_right" style="background-color: #F9E3D6; font-style: italic;">686.032</td>
<td headers="std.error" class="gt_row gt_right" style="background-color: #F9E3D6; font-style: italic;">8.697</td>
<td headers="statistic" class="gt_row gt_right" style="background-color: #F9E3D6; font-style: italic;">78.882</td>
<td headers="p.value" class="gt_row gt_right" style="background-color: #F9E3D6; font-style: italic;">0</td>
<td headers="star" class="gt_row gt_right" style="background-color: #F9E3D6; font-style: italic;">***</td></tr>
    <tr><td headers="term" class="gt_row gt_left">taux d'encadrement</td>
<td headers="estimate" class="gt_row gt_right" style="background-color: #F9E3D6; font-style: italic;">-1.101</td>
<td headers="std.error" class="gt_row gt_right" style="background-color: #F9E3D6; font-style: italic;">0.431</td>
<td headers="statistic" class="gt_row gt_right" style="background-color: #F9E3D6; font-style: italic;">-2.553</td>
<td headers="p.value" class="gt_row gt_right" style="background-color: #F9E3D6; font-style: italic;">0.011</td>
<td headers="star" class="gt_row gt_right" style="background-color: #F9E3D6; font-style: italic;">**</td></tr>
    <tr><td headers="term" class="gt_row gt_left" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">% de non angl</td>
<td headers="estimate" class="gt_row gt_right" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">-0.65</td>
<td headers="std.error" class="gt_row gt_right" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">0.031</td>
<td headers="statistic" class="gt_row gt_right" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">-21.014</td>
<td headers="p.value" class="gt_row gt_right" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">0</td>
<td headers="star" class="gt_row gt_right" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">***</td></tr>
    <tr><td headers="term" class="gt_row gt_left">Adj_R2</td>
<td headers="estimate" class="gt_row gt_right">0.4237</td>
<td headers="std.error" class="gt_row gt_right"></td>
<td headers="statistic" class="gt_row gt_right"></td>
<td headers="p.value" class="gt_row gt_right"></td>
<td headers="star" class="gt_row gt_right"></td></tr>
    <tr><td headers="term" class="gt_row gt_left">F de fisher</td>
<td headers="estimate" class="gt_row gt_right">155.01</td>
<td headers="std.error" class="gt_row gt_right">***</td>
<td headers="statistic" class="gt_row gt_right"></td>
<td headers="p.value" class="gt_row gt_right"></td>
<td headers="star" class="gt_row gt_right"></td></tr>
    <tr><td headers="term" class="gt_row gt_left" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">nobs</td>
<td headers="estimate" class="gt_row gt_right" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">420</td>
<td headers="std.error" class="gt_row gt_right" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td>
<td headers="statistic" class="gt_row gt_right" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td>
<td headers="p.value" class="gt_row gt_right" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td>
<td headers="star" class="gt_row gt_right" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td></tr>
  </tbody>
  
  
</table>
</div>
<p>La second option ‘col_sd’ présente les résultats en colonnes mais en se limitant pour les testes à fournir l’erreur-standard entre parenthèses sous le coefficient.</p>
<pre class="r"><code>reg_base&lt;-reg_(testscr~str+el_pct,don=dat,opt=&#39;col_sd&#39;,
               lab=c(&#39;constante&#39;,&quot;taux d&#39;encadrement&quot;,
                     &#39;% de non angl&#39;))
reg_base</code></pre>
<pre><code>## # A tibble: 9 × 3
##   term                 mod[,1]   ` `[,1]
##   &lt;chr&gt;                &lt;chr&gt;     &lt;chr&gt;  
## 1 &quot;constante&quot;          686.032   &quot;***&quot;  
## 2 &quot;&quot;                   ( 8.697 ) &quot;&quot;     
## 3 &quot;taux d&#39;encadrement&quot; -1.101    &quot;**&quot;   
## 4 &quot;&quot;                   ( 0.431 ) &quot;&quot;     
## 5 &quot;% de non angl&quot;      -0.65     &quot;***&quot;  
## 6 &quot;&quot;                   ( 0.031 ) &quot;&quot;     
## 7 &quot;Adj_R2&quot;             0.4237    &quot;&quot;     
## 8 &quot;F de fisher&quot;        155.01    &quot;***&quot;  
## 9 &quot;nobs&quot;               420       &quot;&quot;</code></pre>
<p>Procédons de la même manière que précédemment en créant une fonction de mise en forme.</p>
<pre class="r"><code>mis_col_sd&lt;-function(t){
  gt(t) %&gt;% 
  tab_style(style=list(cell_fill(color = &quot;#F9E3D6&quot;),
                       cell_text(style = &quot;italic&quot;)),
            locations = cells_body(columns = c(2:length(t)),
                                   rows=c(1:6)))%&gt;% 
  tab_style(style = cell_borders(sides = &quot;bottom&quot;,color = &quot;black&quot;,
                                 weight = px(2),style = &quot;solid&quot;),
            locations = cells_body(columns = everything(),
                                   rows = c(6,9)))}</code></pre>
<p>Voyons ce que cela donne.</p>
<pre class="r"><code>mis_col_sd(reg_base)</code></pre>
<div id="kmavurqzdy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#kmavurqzdy .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kmavurqzdy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kmavurqzdy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kmavurqzdy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kmavurqzdy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kmavurqzdy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kmavurqzdy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kmavurqzdy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kmavurqzdy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kmavurqzdy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kmavurqzdy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kmavurqzdy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kmavurqzdy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kmavurqzdy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kmavurqzdy .gt_from_md > :first-child {
  margin-top: 0;
}

#kmavurqzdy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kmavurqzdy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kmavurqzdy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kmavurqzdy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kmavurqzdy .gt_row_group_first td {
  border-top-width: 2px;
}

#kmavurqzdy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmavurqzdy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kmavurqzdy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kmavurqzdy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kmavurqzdy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmavurqzdy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kmavurqzdy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kmavurqzdy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kmavurqzdy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kmavurqzdy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmavurqzdy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kmavurqzdy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmavurqzdy .gt_left {
  text-align: left;
}

#kmavurqzdy .gt_center {
  text-align: center;
}

#kmavurqzdy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kmavurqzdy .gt_font_normal {
  font-weight: normal;
}

#kmavurqzdy .gt_font_bold {
  font-weight: bold;
}

#kmavurqzdy .gt_font_italic {
  font-style: italic;
}

#kmavurqzdy .gt_super {
  font-size: 65%;
}

#kmavurqzdy .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#kmavurqzdy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kmavurqzdy .gt_indent_1 {
  text-indent: 5px;
}

#kmavurqzdy .gt_indent_2 {
  text-indent: 10px;
}

#kmavurqzdy .gt_indent_3 {
  text-indent: 15px;
}

#kmavurqzdy .gt_indent_4 {
  text-indent: 20px;
}

#kmavurqzdy .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="mod">mod</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id=" "> </th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">constante</td>
<td headers="mod" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">686.032</td>
<td headers="" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">***</td></tr>
    <tr><td headers="term" class="gt_row gt_left"></td>
<td headers="mod" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">( 8.697 )</td>
<td headers="" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;"></td></tr>
    <tr><td headers="term" class="gt_row gt_left">taux d'encadrement</td>
<td headers="mod" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">-1.101</td>
<td headers="" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">**</td></tr>
    <tr><td headers="term" class="gt_row gt_left"></td>
<td headers="mod" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">( 0.431 )</td>
<td headers="" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;"></td></tr>
    <tr><td headers="term" class="gt_row gt_left">% de non angl</td>
<td headers="mod" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">-0.65</td>
<td headers="" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">***</td></tr>
    <tr><td headers="term" class="gt_row gt_left" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td>
<td headers="mod" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">( 0.031 )</td>
<td headers="" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td></tr>
    <tr><td headers="term" class="gt_row gt_left">Adj_R2</td>
<td headers="mod" class="gt_row gt_center">0.4237</td>
<td headers="" class="gt_row gt_center"></td></tr>
    <tr><td headers="term" class="gt_row gt_left">F de fisher</td>
<td headers="mod" class="gt_row gt_center">155.01</td>
<td headers="" class="gt_row gt_center">***</td></tr>
    <tr><td headers="term" class="gt_row gt_left" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">nobs</td>
<td headers="mod" class="gt_row gt_center" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">420</td>
<td headers="" class="gt_row gt_center" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td></tr>
  </tbody>
  
  
</table>
</div>
<p>Au delà des questions de mise en forme, on retrouve bien les résultats déjà mis en évidence dans le post TQG 4 (tâche 2). Si on examine les résidus de la régression, on est proche de la loi normale.</p>
<pre class="r"><code>hist_dist_(var1 = lm(testscr~str+el_pct,data=dat)$residu,
           df=dat,nom=&quot;residus&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Cela se voit aussi bien graphiquement que sur la base des skewness et kurtosis.</p>
<pre class="r"><code>c(sk=skewness(lm(testscr~str+el_pct,data=dat)$residu),
  kurt=kurtosis(lm(testscr~str+el_pct,data=dat)$residu))</code></pre>
<pre><code>##         sk       kurt 
## 0.08779899 3.02389815</code></pre>
<div id="le-passage-par-le-log" class="section level1">
<h1>le passage par le log</h1>
<p>Une des façons de linéariser les relations mises en évidence dans une régression est de passer l’ensemble par le logarithme en veillant à éviter les cas de log(0). Le passage au log rapproche la distribution de la variable de celle d’une loi normale (log normale).</p>
<p>Procédons à la transformation sur nos variables.</p>
<pre class="r"><code>dat_log&lt;-dat %&gt;% mutate(
  testscr=log(testscr+1),str=log(str+1),el_pct=log(el_pct+1))</code></pre>
<p>Observons ses conséquences à partir des histogrammes des variables nouvelles versions.</p>
<pre class="r"><code>G1&lt;-hist_dist_(var1 = testscr,df=dat_log,nom=&quot;score&quot;)
G2&lt;-hist_dist_(var1 = str,df=dat_log,nom=&quot;taux d&#39;encadrement&quot;)
G3&lt;-hist_dist_(var1 = el_pct,df=dat_log,nom=&quot;% de non angl&quot;)
G1/(G2+G3)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Si ce n’est les échelles, peu de choses ont changé concernant nos deux premières variables. Par contre, on voit clairement un changement pour le % de non anglophone. La distribution après légèrement moins éloignée d’une loi normale (même si c’est très loin d’être parfait).</p>
<p>Ré-estimons le modèle sur la base avec nos variables transformées et accolons ces résultats à ceux obtenus sur les données brutes.</p>
<pre class="r"><code>reg_log&lt;-reg_(testscr~str+el_pct,don=dat_log,opt=&#39;col_sd&#39;,
               lab=c(&#39;constante&#39;,&quot;taux d&#39;encadrement&quot;,
                     &#39;% de non angl&#39;))
tab&lt;-cbind(reg_base,reg_log[,2:3])
colnames(tab)&lt;-c(&#39;variables&#39;,&#39;base&#39;,&#39;st&#39;,&#39;log&#39;,&#39;st_&#39;)
mis_col_sd(tab)</code></pre>
<div id="akztqmojxh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#akztqmojxh .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#akztqmojxh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#akztqmojxh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#akztqmojxh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#akztqmojxh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#akztqmojxh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#akztqmojxh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#akztqmojxh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#akztqmojxh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#akztqmojxh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#akztqmojxh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#akztqmojxh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#akztqmojxh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#akztqmojxh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#akztqmojxh .gt_from_md > :first-child {
  margin-top: 0;
}

#akztqmojxh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#akztqmojxh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#akztqmojxh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#akztqmojxh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#akztqmojxh .gt_row_group_first td {
  border-top-width: 2px;
}

#akztqmojxh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#akztqmojxh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#akztqmojxh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#akztqmojxh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#akztqmojxh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#akztqmojxh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#akztqmojxh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#akztqmojxh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#akztqmojxh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#akztqmojxh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#akztqmojxh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#akztqmojxh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#akztqmojxh .gt_left {
  text-align: left;
}

#akztqmojxh .gt_center {
  text-align: center;
}

#akztqmojxh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#akztqmojxh .gt_font_normal {
  font-weight: normal;
}

#akztqmojxh .gt_font_bold {
  font-weight: bold;
}

#akztqmojxh .gt_font_italic {
  font-style: italic;
}

#akztqmojxh .gt_super {
  font-size: 65%;
}

#akztqmojxh .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#akztqmojxh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#akztqmojxh .gt_indent_1 {
  text-indent: 5px;
}

#akztqmojxh .gt_indent_2 {
  text-indent: 10px;
}

#akztqmojxh .gt_indent_3 {
  text-indent: 15px;
}

#akztqmojxh .gt_indent_4 {
  text-indent: 20px;
}

#akztqmojxh .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="variables">variables</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="base">base</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="st">st</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="log">log</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="st_">st_</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="variables" class="gt_row gt_left">constante</td>
<td headers="base" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">686.032</td>
<td headers="st" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">***</td>
<td headers="log" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">6.585</td>
<td headers="st_" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">***</td></tr>
    <tr><td headers="variables" class="gt_row gt_left"></td>
<td headers="base" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">( 8.697 )</td>
<td headers="st" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;"></td>
<td headers="log" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">( 0.047 )</td>
<td headers="st_" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;"></td></tr>
    <tr><td headers="variables" class="gt_row gt_left">taux d'encadrement</td>
<td headers="base" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">-1.101</td>
<td headers="st" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">**</td>
<td headers="log" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">-0.024</td>
<td headers="st_" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">**</td></tr>
    <tr><td headers="variables" class="gt_row gt_left"></td>
<td headers="base" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">( 0.431 )</td>
<td headers="st" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;"></td>
<td headers="log" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">( 0.015 )</td>
<td headers="st_" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;"></td></tr>
    <tr><td headers="variables" class="gt_row gt_left">% de non angl</td>
<td headers="base" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">-0.65</td>
<td headers="st" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">***</td>
<td headers="log" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">-0.013</td>
<td headers="st_" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">***</td></tr>
    <tr><td headers="variables" class="gt_row gt_left" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td>
<td headers="base" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">( 0.031 )</td>
<td headers="st" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td>
<td headers="log" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">( 0.001 )</td>
<td headers="st_" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td></tr>
    <tr><td headers="variables" class="gt_row gt_left">Adj_R2</td>
<td headers="base" class="gt_row gt_center">0.4237</td>
<td headers="st" class="gt_row gt_center"></td>
<td headers="log" class="gt_row gt_center">0.346</td>
<td headers="st_" class="gt_row gt_center"></td></tr>
    <tr><td headers="variables" class="gt_row gt_left">F de fisher</td>
<td headers="base" class="gt_row gt_center">155.01</td>
<td headers="st" class="gt_row gt_center">***</td>
<td headers="log" class="gt_row gt_center">111.83</td>
<td headers="st_" class="gt_row gt_center">***</td></tr>
    <tr><td headers="variables" class="gt_row gt_left" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">nobs</td>
<td headers="base" class="gt_row gt_center" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">420</td>
<td headers="st" class="gt_row gt_center" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td>
<td headers="log" class="gt_row gt_center" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">420</td>
<td headers="st_" class="gt_row gt_center" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td></tr>
  </tbody>
  
  
</table>
</div>
<p>Observons la forme des résidus de cette régression avec un nouvel histogramme.</p>
<pre class="r"><code>hist_dist_(var1 = lm(testscr~str+el_pct,data=dat_log)$residu,
           df=dat_log,nom=&quot;residus&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>On est encore une fois (sans grande surprise) très proche d’une loi normale. On peut le voir également avec les skewness et kurtosis.</p>
<pre class="r"><code>c(sk=skewness(lm(testscr~str+el_pct,data=dat_log)$residu),
  kurt=kurtosis(lm(testscr~str+el_pct,data=dat_log)$residu))</code></pre>
<pre><code>##        sk      kurt 
## 0.1523924 3.0041134</code></pre>
</div>
<div id="la-winsorisation-des-variables" class="section level1">
<h1>la winsorisation des variables</h1>
<p>Une autre manière de traiter les difficultés associées à la forme des variables notamment la présence d’observations atypiques (extrêmes), il s’agit de la winsorisation. En l’appliquant, on remplace les valeurs les plus extrêmes (les plus grandes et les plus petites) par des moins extrêmes. En général, on remplace les données situées en dessous du cinquième percentile par ce percentile et celles situées au dessus de quatre vingt cinquième percentile par celui-ci.</p>
<p>Le package <em>DescTools</em> propose une fonction <strong>Winsorize()</strong>. Utilisons-la sur nos données.</p>
<pre class="r"><code>dat_win&lt;-dat %&gt;% mutate(
  testscr=Winsorize(testscr,probs = c(0.05, 0.95)),
  str=Winsorize(str,probs = c(0.05, 0.95)),
  el_pct=Winsorize(el_pct,probs = c(0.05, 0.95)))</code></pre>
<p>Observons une nouvelle fois les conséquences de cette transformations sur nos données à partir des histogrammes.</p>
<pre class="r"><code>G1&lt;-hist_dist_(var1 = testscr,df=dat_win,nom=&quot;score&quot;)
G2&lt;-hist_dist_(var1 = str,df=dat_win,nom=&quot;taux d&#39;encadrement&quot;)
G3&lt;-hist_dist_(var1 = el_pct,df=dat_win,nom=&quot;% de non angl&quot;)
G1/(G2+G3)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>L’étendu des variables a été réduite et une concentration importante apparaît aux bornes.</p>
<p>Ré-estimons le modèle avec les variables winsorisées.</p>
<pre class="r"><code>reg_win&lt;-reg_(testscr~str+el_pct,don=dat_win,opt=&#39;col_sd&#39;,
               lab=c(&#39;constante&#39;,&quot;taux d&#39;encadrement&quot;,
                     &#39;% de non angl&#39;))
tab&lt;-cbind(reg_base,reg_log[,2:3],reg_win[,2:3])
colnames(tab)&lt;-c(&#39;variables&#39;,&#39;base&#39;,&#39;st&#39;,&#39;log&#39;,&#39;st_&#39;,&#39;win&#39;,&#39;st__&#39;)
mis_col_sd(tab)</code></pre>
<div id="pxclmvxifr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#pxclmvxifr .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pxclmvxifr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pxclmvxifr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pxclmvxifr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pxclmvxifr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pxclmvxifr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pxclmvxifr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pxclmvxifr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pxclmvxifr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pxclmvxifr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pxclmvxifr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pxclmvxifr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pxclmvxifr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pxclmvxifr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pxclmvxifr .gt_from_md > :first-child {
  margin-top: 0;
}

#pxclmvxifr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pxclmvxifr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pxclmvxifr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pxclmvxifr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pxclmvxifr .gt_row_group_first td {
  border-top-width: 2px;
}

#pxclmvxifr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pxclmvxifr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pxclmvxifr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pxclmvxifr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pxclmvxifr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pxclmvxifr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pxclmvxifr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pxclmvxifr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pxclmvxifr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pxclmvxifr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pxclmvxifr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pxclmvxifr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pxclmvxifr .gt_left {
  text-align: left;
}

#pxclmvxifr .gt_center {
  text-align: center;
}

#pxclmvxifr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pxclmvxifr .gt_font_normal {
  font-weight: normal;
}

#pxclmvxifr .gt_font_bold {
  font-weight: bold;
}

#pxclmvxifr .gt_font_italic {
  font-style: italic;
}

#pxclmvxifr .gt_super {
  font-size: 65%;
}

#pxclmvxifr .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#pxclmvxifr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pxclmvxifr .gt_indent_1 {
  text-indent: 5px;
}

#pxclmvxifr .gt_indent_2 {
  text-indent: 10px;
}

#pxclmvxifr .gt_indent_3 {
  text-indent: 15px;
}

#pxclmvxifr .gt_indent_4 {
  text-indent: 20px;
}

#pxclmvxifr .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="variables">variables</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="base">base</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="st">st</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="log">log</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="st_">st_</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="win">win</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="st__">st__</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="variables" class="gt_row gt_left">constante</td>
<td headers="base" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">686.032</td>
<td headers="st" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">***</td>
<td headers="log" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">6.585</td>
<td headers="st_" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">***</td>
<td headers="win" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">681.784</td>
<td headers="st__" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">***</td></tr>
    <tr><td headers="variables" class="gt_row gt_left"></td>
<td headers="base" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">( 8.697 )</td>
<td headers="st" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;"></td>
<td headers="log" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">( 0.047 )</td>
<td headers="st_" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;"></td>
<td headers="win" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">( 8.512 )</td>
<td headers="st__" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;"></td></tr>
    <tr><td headers="variables" class="gt_row gt_left">taux d'encadrement</td>
<td headers="base" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">-1.101</td>
<td headers="st" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">**</td>
<td headers="log" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">-0.024</td>
<td headers="st_" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">**</td>
<td headers="win" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">-0.896</td>
<td headers="st__" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">**</td></tr>
    <tr><td headers="variables" class="gt_row gt_left"></td>
<td headers="base" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">( 0.431 )</td>
<td headers="st" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;"></td>
<td headers="log" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">( 0.015 )</td>
<td headers="st_" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;"></td>
<td headers="win" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">( 0.428 )</td>
<td headers="st__" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;"></td></tr>
    <tr><td headers="variables" class="gt_row gt_left">% de non angl</td>
<td headers="base" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">-0.65</td>
<td headers="st" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">***</td>
<td headers="log" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">-0.013</td>
<td headers="st_" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">***</td>
<td headers="win" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">-0.673</td>
<td headers="st__" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic;">***</td></tr>
    <tr><td headers="variables" class="gt_row gt_left" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td>
<td headers="base" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">( 0.031 )</td>
<td headers="st" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td>
<td headers="log" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">( 0.001 )</td>
<td headers="st_" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td>
<td headers="win" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">( 0.031 )</td>
<td headers="st__" class="gt_row gt_center" style="background-color: #F9E3D6; font-style: italic; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td></tr>
    <tr><td headers="variables" class="gt_row gt_left">Adj_R2</td>
<td headers="base" class="gt_row gt_center">0.4237</td>
<td headers="st" class="gt_row gt_center"></td>
<td headers="log" class="gt_row gt_center">0.346</td>
<td headers="st_" class="gt_row gt_center"></td>
<td headers="win" class="gt_row gt_center">0.4389</td>
<td headers="st__" class="gt_row gt_center"></td></tr>
    <tr><td headers="variables" class="gt_row gt_left">F de fisher</td>
<td headers="base" class="gt_row gt_center">155.01</td>
<td headers="st" class="gt_row gt_center">***</td>
<td headers="log" class="gt_row gt_center">111.83</td>
<td headers="st_" class="gt_row gt_center">***</td>
<td headers="win" class="gt_row gt_center">164.87</td>
<td headers="st__" class="gt_row gt_center">***</td></tr>
    <tr><td headers="variables" class="gt_row gt_left" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">nobs</td>
<td headers="base" class="gt_row gt_center" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">420</td>
<td headers="st" class="gt_row gt_center" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td>
<td headers="log" class="gt_row gt_center" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">420</td>
<td headers="st_" class="gt_row gt_center" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td>
<td headers="win" class="gt_row gt_center" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">420</td>
<td headers="st__" class="gt_row gt_center" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;"></td></tr>
  </tbody>
  
  
</table>
</div>
<p>Examinons les résidus.</p>
<pre class="r"><code>hist_dist_(var1 = lm(testscr~str+el_pct,data=dat_win)$residu,df=dat_win,
           nom=&quot;residus&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>On est encore une fois (sans grande surprise) très proche d’une loi normale. On peut le voir également avec les skewness. Les choses sont moins nettes sur la kurtosis puisque l’on a renforcé les valeurs correspondant au 5ème et 95ème percentile.</p>
<pre class="r"><code>c(sk=skewness(lm(testscr~str+el_pct,data=dat_win)$residu),
  kurt=kurtosis(lm(testscr~str+el_pct,data=dat_win)$residu))</code></pre>
<pre><code>##          sk        kurt 
## -0.03580107  2.46159159</code></pre>
</div>

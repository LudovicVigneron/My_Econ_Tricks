---
title: 'Techniques Quantitatives de Gestion : exploitation des données (1)'
author: Ludovic Vigneron
date: '2022-09-20'
categories:
  - Cours
  - R
  - TQG
  - Finance
tags:
  - Cours
  - Exercice
  - r
  - R
  - TQG
---



<p><strong>Ce semestre j’assure quelques travaux dirigés dont l’objectif est de familiariser les étudiants avec un outil de traitement des données Stata. C’est un logiciel que j’ai utilisé longtemps avant de passer à R. Je milite d’ailleurs activement pour que les enseignements de ce type fassent plus de places aux logiciels gratuits que les étudiants peuvent librement pratiquer chez-eux (R ou même Python). En attendant, je réplique son R ici les travaux demandés en ajoutant quelques éléments notamment l’importation des tableaux assemblés dans un fichier .docx (Word).</strong></p>
<p>Je prend l’option ici de détailler les choses par travaux demandés selon les séances. Commençons donc par la première qui est centrée sur les statistiques descriptives.</p>
<div id="tâche-n1-répliquez-le-tableau-ci-contre" class="section level1">
<h1>Tâche n°1 : répliquez le tableau ci-contre</h1>
<p><img src="tab_rep.PNG" /></p>
<p>Il s’agit d’utiliser les données STAR qui portent sur les résultats aux <strong>California Standardized Testing and Reporting dataset</strong> que l’on peut télécharger <a href="caschool.dta">ici</a>.</p>
<p>Copiez-le dans votre environnement de travail. Il s’agit maintenant l’importer dans R. Pour cela, compte tenu du format du fichier qui est spécifique à Stata, il va nous falloir utiliser le package <em>haven</em>. Si vous ne l’avez pas déjà installer, faîtes-le. Nous utiliserons également l’habituel <em>tidyverse</em> de même que le package <em>gt</em> qui permet d’assembler des tableaux à partir d’une syntaxe simple (proche de celle de <em>ggplot</em>).</p>
<p>Commençons donc par les charger dans notre session.</p>
<pre class="r"><code>library(tidyverse)
library(haven)
library(gt)</code></pre>
<p>Utilisons la fonction <strong>read_dta()</strong> pour chager les données. Nommons la data frame générée caschool.</p>
<pre class="r"><code>caschool &lt;- read_dta(&quot;caschool.dta&quot;)</code></pre>
<p>Limitons la base aux deux variables décrites dans le tableau (dans la base str et testscr).</p>
<pre class="r"><code>variables &lt;- caschool %&gt;% select(str,testscr)</code></pre>
<p>Ceci fait, il nous reste à générer les statistiques. Pour ce faire, nous pourrions simplement utilisez <strong>summary()</strong>.</p>
<pre class="r"><code>summary(variables)</code></pre>
<pre><code>##       str           testscr     
##  Min.   :14.00   Min.   :605.5  
##  1st Qu.:18.58   1st Qu.:640.0  
##  Median :19.72   Median :654.5  
##  Mean   :19.64   Mean   :654.2  
##  3rd Qu.:20.87   3rd Qu.:666.7  
##  Max.   :25.80   Max.   :706.8</code></pre>
<p>Cependant, la fonction ne donne pas l’ensemble des statistiques désirées. Par ailleurs, elle n’inclut pas d’options permettons de les intégrer simplement. Reportons-nous sur une solution plus flexible offerte par le <em>tydyverse</em> (par <em>dplyr</em>), la fonction <strong>summarise()</strong> et plus précisément sa variante <strong>summarize-at()</strong>.</p>
<p>Celle-ci présente deux options principales .vars et .funs. La première appel un vecteur contenant les noms de variables mobilisées. La seconde une liste des fonctions qui seront appliquées à ces variables. Pour commencer, limitons-nous à la seule moyenne. <strong>summarise_at()</strong> génere une tibble qui est une forme de data frame.</p>
<pre class="r"><code>variables %&gt;% summarise_at(
  .vars=c(&quot;testscr&quot;,&quot;str&quot;),
  .funs= list(~mean(.)))</code></pre>
<pre><code>## # A tibble: 1 × 2
##   testscr   str
##     &lt;dbl&gt; &lt;dbl&gt;
## 1    654.  19.6</code></pre>
<p><strong>summarise_at()</strong> génere une tibble qui est une forme de data frame. Notez la syntaxe particulière de la liste de fonction avec le ~ qui annonce le nom de la fonction et le . qui indique que l’on reprend les variables indiquées plus haut.</p>
<p>Mettons l’ensemble en colonne en passant la tibble en vecteur et en transformant l’ensemble en une matrice deux lignes, une colonne. Nous pourrions faire les choses plus simplement à ce stade en utilisant la fonction transpose <strong>t()</strong> par exemple. Cependant, ce surplus de complexité nous permettra de rendre l’ensemble plus flexible.</p>
<pre class="r"><code>variables %&gt;% summarise_at(
  .vars=c(&quot;testscr&quot;,&quot;str&quot;),
  .funs= list(~mean(.))) %&gt;% 
  unlist() %&gt;% matrix(nrow =2 ,ncol=1)</code></pre>
<pre><code>##           [,1]
## [1,] 654.15655
## [2,]  19.64043</code></pre>
<p>Le tableau est dans le bon sens. C’est déjà ça… reste qu’il est peu lisible. Ajoutons des étiquettes aux variables. Commençons par créer un vecteur les incluant.</p>
<pre class="r"><code>labels&lt;-c(&#39;Student-teacher ratio&#39;,&#39;Test score&#39;)</code></pre>
<p>Limitons les valeurs à une décimal. Puis transformons l’ensemble en data frame avec une première colonne indiquant le nom des variables.</p>
<pre class="r"><code>variables %&gt;% summarise_at(
  .vars=c(&quot;testscr&quot;,&quot;str&quot;),
  .funs= list(~mean(.))) %&gt;% 
  unlist() %&gt;% matrix(nrow =2 ,ncol=1) %&gt;% 
  round(digits=1) %&gt;% 
  data.frame(labels,.)</code></pre>
<pre><code>##                  labels     .
## 1 Student-teacher ratio 654.2
## 2            Test score  19.6</code></pre>
<p>Ajoutons l’indication de la statistique représentée simplement avec <strong>colnames()</strong>.</p>
<pre class="r"><code>tab&lt;-variables %&gt;% summarise_at(
    .vars=c(&quot;testscr&quot;,&quot;str&quot;),
    .funs= list(~mean(.))) %&gt;% 
    unlist() %&gt;% matrix(nrow =2 ,ncol=1) %&gt;% 
    round(digits=1) %&gt;% 
    data.frame(labels,.)
colnames(tab)&lt;-c(&#39; &#39;,&#39;Average&#39;)
tab</code></pre>
<pre><code>##                         Average
## 1 Student-teacher ratio   654.2
## 2            Test score    19.6</code></pre>
<p>La structure du tableau est bonne. Il ne nous reste plus qu’à intégrer les autres statistiques avec les fonctions correspondant <strong>sd()</strong> pour l’écart type, <strong>quantile()</strong> en indiquant la proportion d’observations considéré (avec l’option probs) et <strong>median()</strong> pour le quantile à 0,5. Ce faisant nous ajustons le nombre de colonne qui passe de 1 à 9 et allongeons la liste des noms de statistique reprise pour les colonnes. Profitons en pour nommer la data frame générée tab. Cela nous permettra de la mobiliser par la suite de manière obtenir un tableau mis en forme.</p>
<pre class="r"><code>tab&lt;-variables %&gt;% summarise_at(
    .vars=c(&quot;testscr&quot;,&quot;str&quot;),
    .funs= list(~mean(.),~sd(.),~quantile(.,probs=.1),
                ~quantile(.,probs=.25),~quantile(.,probs=.4),
                ~median(.),~quantile(.,probs=.6),~quantile(.,probs=.75),
                ~quantile(.,probs=.9))) %&gt;% 
    unlist() %&gt;% matrix(nrow =2 ,ncol=9) %&gt;% 
    round(digits=1) %&gt;% 
    data.frame(labels,.)
colnames(tab)&lt;-c(&#39; &#39;,&#39;Average&#39;,&#39;Standard Deviation&#39;,
                &#39;10%&#39;,&#39;25%&#39;,&#39;40%&#39;,&#39;50% (median)&#39;,&#39;60%&#39;,&#39;75%&#39;,&#39;90%&#39;)
tab</code></pre>
<pre><code>##                         Average Standard Deviation   10%   25%   40%
## 1 Student-teacher ratio   654.2               19.1 630.4 640.0 649.1
## 2            Test score    19.6                1.9  17.3  18.6  19.3
##   50% (median)   60%   75%   90%
## 1        654.4 659.4 666.7 678.9
## 2         19.7  20.1  20.9  21.9</code></pre>
<p>C’est à ce stade que le package <em>gt</em> entre en scène. La fonction <strong>gt()</strong> permet d’obtenir une version image du tableau.</p>
<pre class="r"><code>gt(tab)</code></pre>
<div id="dnrsuaqppk" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#dnrsuaqppk .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dnrsuaqppk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dnrsuaqppk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dnrsuaqppk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dnrsuaqppk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dnrsuaqppk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dnrsuaqppk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dnrsuaqppk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dnrsuaqppk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dnrsuaqppk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dnrsuaqppk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dnrsuaqppk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#dnrsuaqppk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dnrsuaqppk .gt_from_md > :first-child {
  margin-top: 0;
}

#dnrsuaqppk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dnrsuaqppk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dnrsuaqppk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dnrsuaqppk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dnrsuaqppk .gt_row_group_first td {
  border-top-width: 2px;
}

#dnrsuaqppk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dnrsuaqppk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dnrsuaqppk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dnrsuaqppk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dnrsuaqppk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dnrsuaqppk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dnrsuaqppk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dnrsuaqppk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dnrsuaqppk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dnrsuaqppk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dnrsuaqppk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dnrsuaqppk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dnrsuaqppk .gt_left {
  text-align: left;
}

#dnrsuaqppk .gt_center {
  text-align: center;
}

#dnrsuaqppk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dnrsuaqppk .gt_font_normal {
  font-weight: normal;
}

#dnrsuaqppk .gt_font_bold {
  font-weight: bold;
}

#dnrsuaqppk .gt_font_italic {
  font-style: italic;
}

#dnrsuaqppk .gt_super {
  font-size: 65%;
}

#dnrsuaqppk .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#dnrsuaqppk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dnrsuaqppk .gt_indent_1 {
  text-indent: 5px;
}

#dnrsuaqppk .gt_indent_2 {
  text-indent: 10px;
}

#dnrsuaqppk .gt_indent_3 {
  text-indent: 15px;
}

#dnrsuaqppk .gt_indent_4 {
  text-indent: 20px;
}

#dnrsuaqppk .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col"> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Average</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Standard Deviation</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">10%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">25%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">40%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">50% (median)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">60%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">75%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">90%</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Student-teacher ratio</td>
<td class="gt_row gt_right">654.2</td>
<td class="gt_row gt_right">19.1</td>
<td class="gt_row gt_right">630.4</td>
<td class="gt_row gt_right">640.0</td>
<td class="gt_row gt_right">649.1</td>
<td class="gt_row gt_right">654.4</td>
<td class="gt_row gt_right">659.4</td>
<td class="gt_row gt_right">666.7</td>
<td class="gt_row gt_right">678.9</td></tr>
    <tr><td class="gt_row gt_left">Test score</td>
<td class="gt_row gt_right">19.6</td>
<td class="gt_row gt_right">1.9</td>
<td class="gt_row gt_right">17.3</td>
<td class="gt_row gt_right">18.6</td>
<td class="gt_row gt_right">19.3</td>
<td class="gt_row gt_right">19.7</td>
<td class="gt_row gt_right">20.1</td>
<td class="gt_row gt_right">20.9</td>
<td class="gt_row gt_right">21.9</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Modifions cette image pour intégrer le titre ainsi qu’une étiquette étendue pour les différents percentiles reportés.</p>
<pre class="r"><code>tab&lt;-gt(tab) %&gt;% 
  tab_header(title=&#39;Summary of the distribution of Student-Teacher Ratios and
             Fifth-Grade Test Score for 420 K-8 Districts in California in 1998&#39;) %&gt;%   tab_spanner(label = &quot;Percentiles&quot;,
              columns = c(&#39;10%&#39;,&#39;25%&#39;,&#39;40%&#39;,&#39;50% (median)&#39;,&#39;60%&#39;,&#39;75%&#39;,&#39;90%&#39;))
tab</code></pre>
<div id="akasehsxsy" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#akasehsxsy .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#akasehsxsy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#akasehsxsy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#akasehsxsy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#akasehsxsy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#akasehsxsy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#akasehsxsy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#akasehsxsy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#akasehsxsy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#akasehsxsy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#akasehsxsy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#akasehsxsy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#akasehsxsy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#akasehsxsy .gt_from_md > :first-child {
  margin-top: 0;
}

#akasehsxsy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#akasehsxsy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#akasehsxsy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#akasehsxsy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#akasehsxsy .gt_row_group_first td {
  border-top-width: 2px;
}

#akasehsxsy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#akasehsxsy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#akasehsxsy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#akasehsxsy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#akasehsxsy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#akasehsxsy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#akasehsxsy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#akasehsxsy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#akasehsxsy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#akasehsxsy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#akasehsxsy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#akasehsxsy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#akasehsxsy .gt_left {
  text-align: left;
}

#akasehsxsy .gt_center {
  text-align: center;
}

#akasehsxsy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#akasehsxsy .gt_font_normal {
  font-weight: normal;
}

#akasehsxsy .gt_font_bold {
  font-weight: bold;
}

#akasehsxsy .gt_font_italic {
  font-style: italic;
}

#akasehsxsy .gt_super {
  font-size: 65%;
}

#akasehsxsy .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#akasehsxsy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#akasehsxsy .gt_indent_1 {
  text-indent: 5px;
}

#akasehsxsy .gt_indent_2 {
  text-indent: 10px;
}

#akasehsxsy .gt_indent_3 {
  text-indent: 15px;
}

#akasehsxsy .gt_indent_4 {
  text-indent: 20px;
}

#akasehsxsy .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  <thead class="gt_header">
    <tr>
      <td colspan="10" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Summary of the distribution of Student-Teacher Ratios and
             Fifth-Grade Test Score for 420 K-8 Districts in California in 1998</td>
    </tr>
    
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col"> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">Average</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">Standard Deviation</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="7" scope="colgroup">
        <span class="gt_column_spanner">Percentiles</span>
      </th>
    </tr>
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">10%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">25%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">40%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">50% (median)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">60%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">75%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">90%</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Student-teacher ratio</td>
<td class="gt_row gt_right">654.2</td>
<td class="gt_row gt_right">19.1</td>
<td class="gt_row gt_right">630.4</td>
<td class="gt_row gt_right">640.0</td>
<td class="gt_row gt_right">649.1</td>
<td class="gt_row gt_right">654.4</td>
<td class="gt_row gt_right">659.4</td>
<td class="gt_row gt_right">666.7</td>
<td class="gt_row gt_right">678.9</td></tr>
    <tr><td class="gt_row gt_left">Test score</td>
<td class="gt_row gt_right">19.6</td>
<td class="gt_row gt_right">1.9</td>
<td class="gt_row gt_right">17.3</td>
<td class="gt_row gt_right">18.6</td>
<td class="gt_row gt_right">19.3</td>
<td class="gt_row gt_right">19.7</td>
<td class="gt_row gt_right">20.1</td>
<td class="gt_row gt_right">20.9</td>
<td class="gt_row gt_right">21.9</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Il ne nous reste plus qu’à exporter le résultat dans Word en créant un fichier .docx grâce à la fonction <strong>gtsave()</strong>. Vous pourrez alors continuer la mise en forme (couleur, gras, italic, police de caractère…).</p>
<pre class="r"><code>tab %&gt;% gtsave(&quot;tab_1.docx&quot;)</code></pre>
<p>La fonction permet de générer différents types de fichier (.rtf,.tex,.ltx,.html,.docs).</p>
</div>
<div id="tâche-n2-intégrez-dans-le-tableau-la-skewness-et-la-kurtosis" class="section level1">
<h1>Tâche n°2 : intégrez dans le tableau la Skewness et la Kurtosis</h1>
<p>Il n’y a pas dans R base de fonction dédiée à ces statistiques. Nous pourrions en écrire mais le plus simple est d’utiliser le package <em>moments</em>. Installez-le / chargez-le.</p>
<pre class="r"><code>library(moments)</code></pre>
<p>On a alors accès aux fonctions <strong>skewness()</strong> et <strong>kurtosis()</strong> que l’on peut intégrer dans notre tableau. Celui-ci aura 11 colonnes. Plaçons les après l’écart type.</p>
<pre class="r"><code>tab&lt;-variables %&gt;% summarise_at(
    .vars=c(&quot;testscr&quot;,&quot;str&quot;),
    .funs= list(~mean(.),~sd(.),~skewness(.),~kurtosis(.),~quantile(.,probs=.1),
                ~quantile(.,probs=.25),~quantile(.,probs=.4),
                ~median(.),~quantile(.,probs=.6),~quantile(.,probs=.75),
                ~quantile(.,probs=.9))) %&gt;% 
    unlist() %&gt;% matrix(nrow =2 ,ncol=11) %&gt;% 
    round(digits=1) %&gt;% 
    data.frame(labels,.)
colnames(tab)&lt;-c(&#39; &#39;,&#39;Average&#39;,&#39;Standard Deviation&#39;,&#39;Skewness&#39;,&#39;Kurtosis&#39;,
                 &#39;10%&#39;,&#39;25%&#39;,&#39;40%&#39;,&#39;50% (median)&#39;,&#39;60%&#39;,&#39;75%&#39;,&#39;90%&#39;)
tab&lt;-gt(tab) %&gt;% 
  tab_header(title=&#39;Summary of the distribution of Student-Teacher Ratios 
             and Fifth-Grade Test Score for 420 K-8 Districts in California in 1998&#39;) %&gt;% 
  tab_spanner(label = &quot;Percentiles&quot;,
              columns = c(&#39;10%&#39;,&#39;25%&#39;,&#39;40%&#39;,&#39;50% (median)&#39;,&#39;60%&#39;,&#39;75%&#39;,&#39;90%&#39;))
tab</code></pre>
<div id="sozszguhrj" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#sozszguhrj .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sozszguhrj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sozszguhrj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sozszguhrj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sozszguhrj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sozszguhrj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sozszguhrj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sozszguhrj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sozszguhrj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sozszguhrj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sozszguhrj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sozszguhrj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#sozszguhrj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sozszguhrj .gt_from_md > :first-child {
  margin-top: 0;
}

#sozszguhrj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sozszguhrj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sozszguhrj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#sozszguhrj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sozszguhrj .gt_row_group_first td {
  border-top-width: 2px;
}

#sozszguhrj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sozszguhrj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sozszguhrj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sozszguhrj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sozszguhrj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sozszguhrj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sozszguhrj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sozszguhrj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sozszguhrj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sozszguhrj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sozszguhrj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sozszguhrj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sozszguhrj .gt_left {
  text-align: left;
}

#sozszguhrj .gt_center {
  text-align: center;
}

#sozszguhrj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sozszguhrj .gt_font_normal {
  font-weight: normal;
}

#sozszguhrj .gt_font_bold {
  font-weight: bold;
}

#sozszguhrj .gt_font_italic {
  font-style: italic;
}

#sozszguhrj .gt_super {
  font-size: 65%;
}

#sozszguhrj .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#sozszguhrj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sozszguhrj .gt_indent_1 {
  text-indent: 5px;
}

#sozszguhrj .gt_indent_2 {
  text-indent: 10px;
}

#sozszguhrj .gt_indent_3 {
  text-indent: 15px;
}

#sozszguhrj .gt_indent_4 {
  text-indent: 20px;
}

#sozszguhrj .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  <thead class="gt_header">
    <tr>
      <td colspan="12" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Summary of the distribution of Student-Teacher Ratios 
             and Fifth-Grade Test Score for 420 K-8 Districts in California in 1998</td>
    </tr>
    
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col"> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">Average</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">Standard Deviation</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">Skewness</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">Kurtosis</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="7" scope="colgroup">
        <span class="gt_column_spanner">Percentiles</span>
      </th>
    </tr>
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">10%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">25%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">40%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">50% (median)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">60%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">75%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">90%</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Student-teacher ratio</td>
<td class="gt_row gt_right">654.2</td>
<td class="gt_row gt_right">19.1</td>
<td class="gt_row gt_right">0.1</td>
<td class="gt_row gt_right">2.7</td>
<td class="gt_row gt_right">630.4</td>
<td class="gt_row gt_right">640.0</td>
<td class="gt_row gt_right">649.1</td>
<td class="gt_row gt_right">654.4</td>
<td class="gt_row gt_right">659.4</td>
<td class="gt_row gt_right">666.7</td>
<td class="gt_row gt_right">678.9</td></tr>
    <tr><td class="gt_row gt_left">Test score</td>
<td class="gt_row gt_right">19.6</td>
<td class="gt_row gt_right">1.9</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.6</td>
<td class="gt_row gt_right">17.3</td>
<td class="gt_row gt_right">18.6</td>
<td class="gt_row gt_right">19.3</td>
<td class="gt_row gt_right">19.7</td>
<td class="gt_row gt_right">20.1</td>
<td class="gt_row gt_right">20.9</td>
<td class="gt_row gt_right">21.9</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Comme avec le précédent, on peut simplement l’envoyer dans un document Word.</p>
<pre class="r"><code>tab %&gt;% gtsave(&quot;tab_2.docx&quot;)</code></pre>
</div>
<div id="tâche-n3-faites-la-même-chose-avec-les-portefeuilles-définis-par-taille" class="section level1">
<h1>Tâche n°3 : faites la même chose avec les portefeuilles définis par taille</h1>
<p>Chargeons les nouvelles données pour commencer. Le fichier .dta est disponible <a href="portf_size.dta">ici</a>. Copiez le dans votre dossier de travail et charger les données dans R.</p>
<pre class="r"><code>portf_size&lt;-read_dta(&quot;portf_size.dta&quot;)</code></pre>
<p>Réduisons la base aux seules variables qui nous intéressent et générons un vecteur qui les nomment.</p>
<pre class="r"><code>variables&lt;-portf_size %&gt;% select(Lo10,Hi10)
labels&lt;-c(&#39;Small&#39;,&#39;Big&#39;)</code></pre>
<p>On peut alors reprendre notre programme et l’adapter pour à nos nouvelles données.</p>
<pre class="r"><code>tab&lt;-variables%&gt;% summarise_at(
    .vars=c(&quot;Lo10&quot;,&quot;Hi10&quot;),
    .funs= list(~mean(.),~sd(.),~skewness(.),~kurtosis(.),~quantile(.,probs=.1),
                ~quantile(.,probs=.25),~quantile(.,probs=.4),
                ~median(.),~quantile(.,probs=.6),~quantile(.,probs=.75),
                ~quantile(.,probs=.9))) %&gt;% 
    unlist() %&gt;% matrix(nrow =2 ,ncol=11) %&gt;% 
    round(digits=2) %&gt;% 
    data.frame(labels,.)
colnames(tab)&lt;-c(&#39; &#39;,&#39;Average&#39;,&#39;Standard Deviation&#39;,&#39;Skewness&#39;,&#39;Kurtosis&#39;,
                 &#39;10%&#39;,&#39;25%&#39;,&#39;40%&#39;,&#39;50% (median)&#39;,&#39;60%&#39;,&#39;75%&#39;,&#39;90%&#39;)
tab&lt;-gt(tab) %&gt;% 
  tab_header(title=&#39;&#39;) %&gt;% 
  tab_spanner(label = &quot;Percentiles&quot;,
              columns = c(&#39;10%&#39;,&#39;25%&#39;,&#39;40%&#39;,&#39;50% (median)&#39;,&#39;60%&#39;,&#39;75%&#39;,&#39;90%&#39;))
tab</code></pre>
<div id="jvfrnazcaj" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#jvfrnazcaj .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jvfrnazcaj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jvfrnazcaj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jvfrnazcaj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jvfrnazcaj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jvfrnazcaj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jvfrnazcaj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jvfrnazcaj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jvfrnazcaj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jvfrnazcaj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jvfrnazcaj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jvfrnazcaj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#jvfrnazcaj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jvfrnazcaj .gt_from_md > :first-child {
  margin-top: 0;
}

#jvfrnazcaj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jvfrnazcaj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jvfrnazcaj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jvfrnazcaj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jvfrnazcaj .gt_row_group_first td {
  border-top-width: 2px;
}

#jvfrnazcaj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jvfrnazcaj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jvfrnazcaj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jvfrnazcaj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jvfrnazcaj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jvfrnazcaj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jvfrnazcaj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jvfrnazcaj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jvfrnazcaj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jvfrnazcaj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jvfrnazcaj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jvfrnazcaj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jvfrnazcaj .gt_left {
  text-align: left;
}

#jvfrnazcaj .gt_center {
  text-align: center;
}

#jvfrnazcaj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jvfrnazcaj .gt_font_normal {
  font-weight: normal;
}

#jvfrnazcaj .gt_font_bold {
  font-weight: bold;
}

#jvfrnazcaj .gt_font_italic {
  font-style: italic;
}

#jvfrnazcaj .gt_super {
  font-size: 65%;
}

#jvfrnazcaj .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#jvfrnazcaj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jvfrnazcaj .gt_indent_1 {
  text-indent: 5px;
}

#jvfrnazcaj .gt_indent_2 {
  text-indent: 10px;
}

#jvfrnazcaj .gt_indent_3 {
  text-indent: 15px;
}

#jvfrnazcaj .gt_indent_4 {
  text-indent: 20px;
}

#jvfrnazcaj .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  <thead class="gt_header">
    <tr>
      <td colspan="12" class="gt_heading gt_title gt_font_normal gt_bottom_border" style></td>
    </tr>
    
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col"> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">Average</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">Standard Deviation</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">Skewness</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">Kurtosis</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="7" scope="colgroup">
        <span class="gt_column_spanner">Percentiles</span>
      </th>
    </tr>
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">10%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">25%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">40%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">50% (median)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">60%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">75%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">90%</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Small</td>
<td class="gt_row gt_right">1.76</td>
<td class="gt_row gt_right">10.61</td>
<td class="gt_row gt_right">4.40</td>
<td class="gt_row gt_right">46.82</td>
<td class="gt_row gt_right">-7.32</td>
<td class="gt_row gt_right">-2.72</td>
<td class="gt_row gt_right">-0.25</td>
<td class="gt_row gt_right">1.04</td>
<td class="gt_row gt_right">2.41</td>
<td class="gt_row gt_right">4.92</td>
<td class="gt_row gt_right">9.94</td></tr>
    <tr><td class="gt_row gt_left">Big</td>
<td class="gt_row gt_right">0.90</td>
<td class="gt_row gt_right">5.39</td>
<td class="gt_row gt_right">0.23</td>
<td class="gt_row gt_right">10.65</td>
<td class="gt_row gt_right">-4.83</td>
<td class="gt_row gt_right">-1.68</td>
<td class="gt_row gt_right">0.19</td>
<td class="gt_row gt_right">1.15</td>
<td class="gt_row gt_right">2.02</td>
<td class="gt_row gt_right">3.83</td>
<td class="gt_row gt_right">6.20</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Le résultat on peut alors comme précédemment simplement l’envoyer dans un document Word.</p>
<pre class="r"><code>tab %&gt;% gtsave(&quot;tab_3.docx&quot;)</code></pre>
</div>

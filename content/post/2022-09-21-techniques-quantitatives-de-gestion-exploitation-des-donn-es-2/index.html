---
title: 'Techniques Quantitatives de Gestion: exploitation des données (2)'
author: Ludovic Vigneron
date: '2022-09-21'
slug: []
categories:
  - R
  - Cours
tags:
  - Cours
  - Exercice
  - R
---



<p><strong>Dans cette seconde session, l’objectif est de faire réaliser aux étudiants un test statistique classique, interpréter le résultat et de mettre en forme l’ensemble. On prolonge ici ce qui a été fait sur les écoles en Californie et sur la performance des portefeuilles composés par taille précédemment. La procédure utilisée est le test de Student de différence de moyennes. Ce rapide post reprenant sous R le travail à accomplir avec Stata est l’occasion de passer en revue notamment les différents éléments générés par les fonctions de test et de voir comment les mobiliser pour réaliser un tableau de résultat sur mesure</strong></p>
<div id="tâche-n1-réalisez-un-teste-de-différence-de-moyenne-entre-les-scores-obtenus-par-les-écoles-avec-plus-de-20-enfants-par-classe-et-celles-avec-moins" class="section level1">
<h1>Tâche n°1 réalisez un teste de différence de moyenne entre les scores obtenus par les écoles avec plus de 20 enfants par classe et celles avec moins</h1>
<p>Nous utiliserons ici les mêmes packages (<em>tidyverse</em>, <em>haven</em> et <em>gt</em>) ainsi que les mêmes données que pour la session précédente. Chargeons l’ensemble dans notre environnement de travail.</p>
<pre class="r"><code>library(tidyverse)
library(haven)
library(gt)</code></pre>
<p>Concernant les données portant sur les écoles, importez-les (si ce n’est déjà fait) en cliquant sur le liens suivant: <a href="caschool.dta">ici</a> et placez-les dans votre dossier de travail. On peut alors les importer dans R via la fonction <strong>read_dta()</strong>.</p>
<pre class="r"><code>caschool&lt;-read_dta(&quot;caschool.dta&quot;)</code></pre>
<p>Encore un fois, limitons-nous aux seules variables utiles pour notre analyse.</p>
<pre class="r"><code>variables &lt;- caschool %&gt;% select(str,testscr)</code></pre>
<p>Puis créons une variable, que l’on appellera size, marquant le fait que l’école considérée (l’observation) présente une valeur de str (student-teacher ratio) inférieure ou supérieure à 20. Dans le premier cas, elle prendra la valeur ‘Small’, et dans le second, elle prendra la valeur ‘Large’. L’opération est réalisée en mobilisant la fonction <strong>ifelse()</strong>.</p>
<pre class="r"><code>variables$size&lt;-ifelse(variables$str&lt;20,&#39;Small&#39;,&#39;Large&#39;)</code></pre>
<p>Une fois la variable codée, on peut réaliser le test. Profitons-en pour stocker l’information générée dans un objet nommé test. Affichons le résultat.</p>
<pre class="r"><code>test&lt;-t.test(testscr~size,data=variables)
test</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  testscr by size
## t = -4.0426, df = 403.61, p-value = 6.333e-05
## alternative hypothesis: true difference in means between group Large and group Small is not equal to 0
## 95 percent confidence interval:
##  -10.957525  -3.787296
## sample estimates:
## mean in group Large mean in group Small 
##            649.9788            657.3513</code></pre>
<p>Ici, le test de Student utilisé est celui présent par défaut. On est sur un test bilatéral avec des observations non pairées et correction pour inégalité de variance. Nous constatons une p-value très petite 0.00006333. On rejette donc sans hésitation H0. En observant les moyennes sur les sous groupes, on peut conclure que le score obtenu par les écoles à petite classe est supérieur à celui obtenu par celles à grande classe. Dans 95% des cas, la différence entre ces catégories est comprise entre 10,95 et 3,78.</p>
<p>Voyons comment mettre tout cela en place dans un tableau unique. Générons une data frame avec les informations pertinentes.</p>
<pre class="r"><code>tab&lt;-c(round(mean(variables$testscr),digits=1),
       round(test$estimate,digits=1),
       round(test$statistic,digits=3),
       round(test$p.value,digits=3),
       round(test$conf.int,digits=2))  %&gt;%  t()  %&gt;% data.frame()
colnames(tab)&lt;-c(&#39;Total&#39;,&#39;Grande&#39;,&#39;Petite&#39;,&#39;t de Student&#39;,&#39;p.value&#39;,&#39;Borne base&#39;,&#39;Borne haute&#39;)
tab</code></pre>
<pre><code>##   Total Grande Petite t de Student p.value Borne base Borne haute
## 1 654.2    650  657.4       -4.043       0     -10.96       -3.79</code></pre>
<p>Maintenant que nous avons notre data frame, nous pouvons mettre notre tableau en forme.</p>
<pre class="r"><code>tab_&lt;-gt(tab) %&gt;% 
  tab_header(&#39;Test de différence de moyennes sur les scores obtenus par les école en fonction de la taille de leur classes&#39;) %&gt;% 
  tab_spanner(&#39;Taille de la classe&#39;,columns = c(&#39;Grande&#39;,&#39;Petite&#39;)) %&gt;% 
  tab_spanner(&#39;Interval de Confiance à 95% (diff.moy)&#39;,
              columns = c(&#39;Borne base&#39;,&#39;Borne haute&#39;))
tab_</code></pre>
<div id="nacyzwexxe" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#nacyzwexxe .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nacyzwexxe .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nacyzwexxe .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nacyzwexxe .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nacyzwexxe .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nacyzwexxe .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nacyzwexxe .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nacyzwexxe .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nacyzwexxe .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nacyzwexxe .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nacyzwexxe .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nacyzwexxe .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#nacyzwexxe .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nacyzwexxe .gt_from_md > :first-child {
  margin-top: 0;
}

#nacyzwexxe .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nacyzwexxe .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nacyzwexxe .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nacyzwexxe .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nacyzwexxe .gt_row_group_first td {
  border-top-width: 2px;
}

#nacyzwexxe .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nacyzwexxe .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nacyzwexxe .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nacyzwexxe .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nacyzwexxe .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nacyzwexxe .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nacyzwexxe .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nacyzwexxe .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nacyzwexxe .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nacyzwexxe .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nacyzwexxe .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nacyzwexxe .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nacyzwexxe .gt_left {
  text-align: left;
}

#nacyzwexxe .gt_center {
  text-align: center;
}

#nacyzwexxe .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nacyzwexxe .gt_font_normal {
  font-weight: normal;
}

#nacyzwexxe .gt_font_bold {
  font-weight: bold;
}

#nacyzwexxe .gt_font_italic {
  font-style: italic;
}

#nacyzwexxe .gt_super {
  font-size: 65%;
}

#nacyzwexxe .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#nacyzwexxe .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nacyzwexxe .gt_indent_1 {
  text-indent: 5px;
}

#nacyzwexxe .gt_indent_2 {
  text-indent: 10px;
}

#nacyzwexxe .gt_indent_3 {
  text-indent: 15px;
}

#nacyzwexxe .gt_indent_4 {
  text-indent: 20px;
}

#nacyzwexxe .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  <thead class="gt_header">
    <tr>
      <td colspan="7" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Test de différence de moyennes sur les scores obtenus par les école en fonction de la taille de leur classes</td>
    </tr>
    
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">Total</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup">
        <span class="gt_column_spanner">Taille de la classe</span>
      </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">t de Student</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">p.value</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup">
        <span class="gt_column_spanner">Interval de Confiance à 95% (diff.moy)</span>
      </th>
    </tr>
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Grande</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Petite</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Borne base</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Borne haute</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">654.2</td>
<td class="gt_row gt_right">650</td>
<td class="gt_row gt_right">657.4</td>
<td class="gt_row gt_right">-4.043</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">-10.96</td>
<td class="gt_row gt_right">-3.79</td></tr>
  </tbody>
  
  
</table>
</div>
<p>L’ensemble est satisfaisant, nous pouvons en toute fin utiliser <strong>gtsave()</strong> pour importer le tableau dans Word.</p>
<pre class="r"><code>gtsave(tab_,&#39;dif_moy_scr.docx&#39;)</code></pre>
</div>
<div id="tâche-n2-répliquez-la-procédure-pour-comparer-les-performances-du-portefeuilles-composés-de-grandes-entreprises-à-celui-composés-de-petites" class="section level1">
<h1>Tâche n°2 : Répliquez la procédure pour comparer les performances du portefeuilles composés de grandes entreprises à celui composés de petites</h1>
<p>Commençons donc par importer les données et les mettre dans le dossier de travail. Si vous ne les avez pas déjà, vous pouvez les charger <a href="partf_size.dta">ici</a>. Limitons l’ensemble aux seules variables utiles (Lo10,Hi10).</p>
<pre class="r"><code>portf_size&lt;-read_dta(&quot;portf_size.dta&quot;)
variables&lt;-portf_size %&gt;% select(Lo10,Hi10)</code></pre>
<p>La configuration de la base obtenue n’est pas pratique. Transformons-la de manière à avoir une colonne reprenant l’ensemble des mesures de performance et une autre indiquant si le portefeuille considéré est composé de grande entreprise ou de petite. Pour cela, utilisons la fonction <strong>pivot_longer()</strong> avec comme arguments cols Lo10 et Hi10, names_to Port_size et values_to perf.</p>
<pre class="r"><code>variables_&lt;-pivot_longer(variables,
                         cols=c(Lo10,Hi10),
                         names_to = &#39;Port_size&#39;,
                         values_to = &#39;perf&#39;)</code></pre>
<p>Maintenant que les choses sont en place réalisons le test sans oublier de stocké l’information générée.</p>
<pre class="r"><code>test&lt;-t.test(perf~Port_size,data=variables_)
test</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  perf by Port_size
## t = -2.4292, df = 1655.3, p-value = 0.01524
## alternative hypothesis: true difference in means between group Hi10 and group Lo10 is not equal to 0
## 95 percent confidence interval:
##  -1.5636947 -0.1666186
## sample estimates:
## mean in group Hi10 mean in group Lo10 
##          0.8984781          1.7636347</code></pre>
<p>Si l’on établit la limite d’acceptation à 5%, on rejette H0 (à 1% on ne peut pas rejeté H0). Les portefeuilles de grandes entreprises sous-performer en moyenne par rapport à ceux composés de petites. Mettons ces résultats en forme dans une data frame.</p>
<pre class="r"><code>tab&lt;-c(round(mean(variables_$perf),digits=2),
       round(test$estimate,digits=2),
       round(test$statistic,digits=3),
       round(test$p.value,digits=3),
       round(test$conf.int,digits=2))  %&gt;%  t()  %&gt;% data.frame()
colnames(tab)&lt;-c(&#39;Total&#39;,&#39;Grande&#39;,&#39;Petite&#39;,&#39;t de Student&#39;,&#39;p-value&#39;,&#39;Borne base&#39;,&#39;Borne haute&#39;)
tab</code></pre>
<pre><code>##   Total Grande Petite t de Student p-value Borne base Borne haute
## 1  1.33    0.9   1.76       -2.429   0.015      -1.56       -0.17</code></pre>
<p>A partir de la data frame, on peut mettre en page le tableau via <strong>gt()</strong>.</p>
<pre class="r"><code>tab_&lt;-gt(tab) %&gt;% 
  tab_header(&#39;Test de différence de moyennes sur la performance (rend. jour.) des portefeuilles composés sur la base de la taille des entreprises&#39;) %&gt;% 
  tab_spanner(&#39;Taille des entreprises&#39;,columns = c(&#39;Grande&#39;,&#39;Petite&#39;)) %&gt;% 
  tab_spanner(&#39;Intervalle de Confiance à 95% (diff.moy)&#39;,
              columns = c(&#39;Borne base&#39;,&#39;Borne haute&#39;))
tab_</code></pre>
<div id="vajamafkzf" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#vajamafkzf .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vajamafkzf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vajamafkzf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vajamafkzf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vajamafkzf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vajamafkzf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vajamafkzf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vajamafkzf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vajamafkzf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vajamafkzf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vajamafkzf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vajamafkzf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#vajamafkzf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vajamafkzf .gt_from_md > :first-child {
  margin-top: 0;
}

#vajamafkzf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vajamafkzf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vajamafkzf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vajamafkzf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vajamafkzf .gt_row_group_first td {
  border-top-width: 2px;
}

#vajamafkzf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vajamafkzf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vajamafkzf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vajamafkzf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vajamafkzf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vajamafkzf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vajamafkzf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vajamafkzf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vajamafkzf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vajamafkzf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vajamafkzf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vajamafkzf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vajamafkzf .gt_left {
  text-align: left;
}

#vajamafkzf .gt_center {
  text-align: center;
}

#vajamafkzf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vajamafkzf .gt_font_normal {
  font-weight: normal;
}

#vajamafkzf .gt_font_bold {
  font-weight: bold;
}

#vajamafkzf .gt_font_italic {
  font-style: italic;
}

#vajamafkzf .gt_super {
  font-size: 65%;
}

#vajamafkzf .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#vajamafkzf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vajamafkzf .gt_indent_1 {
  text-indent: 5px;
}

#vajamafkzf .gt_indent_2 {
  text-indent: 10px;
}

#vajamafkzf .gt_indent_3 {
  text-indent: 15px;
}

#vajamafkzf .gt_indent_4 {
  text-indent: 20px;
}

#vajamafkzf .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  <thead class="gt_header">
    <tr>
      <td colspan="7" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Test de différence de moyennes sur la performance (rend. jour.) des portefeuilles composés sur la base de la taille des entreprises</td>
    </tr>
    
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">Total</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup">
        <span class="gt_column_spanner">Taille des entreprises</span>
      </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">t de Student</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">p-value</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup">
        <span class="gt_column_spanner">Intervalle de Confiance à 95% (diff.moy)</span>
      </th>
    </tr>
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Grande</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Petite</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Borne base</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Borne haute</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">1.33</td>
<td class="gt_row gt_right">0.9</td>
<td class="gt_row gt_right">1.76</td>
<td class="gt_row gt_right">-2.429</td>
<td class="gt_row gt_right">0.015</td>
<td class="gt_row gt_right">-1.56</td>
<td class="gt_row gt_right">-0.17</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Le résultat est intéressant. Chargeons-le dans Word pour l’intégrer dans un éventuel rapport.</p>
<pre class="r"><code>gtsave(tab_,&#39;dif_moy_rent.docx&#39;)</code></pre>
</div>

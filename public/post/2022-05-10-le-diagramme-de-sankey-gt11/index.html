<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="google-site-verification" content="gvTIRAZF7KZCKm-syPBJcDj0JiQpJqR6f6uq6PCfZYs" />

        <meta property="og:title" content="Le diagramme de Sankey GT11" />
<meta property="og:description" content="Nous allons ici nous pencher sur un type graphe unique (ou du moins présentant moins de différentes formes que ceux présentés jusqu’ici). Il permet de montrer à la fois comment les effectifs de différentes catégories se comparent entre eux dans un état et comment elles se transforment, se recombinent, pour former d’autres catégories dans un autre état voir plusieurs autres états. Il s’agit du diagramme de Sankey inventé par un ingénieur irlandais qui lui a donné son nom en 1898." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/2022-05-10-le-diagramme-de-sankey-gt11/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-05-10T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-05-10T00:00:00+00:00" />


        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Le diagramme de Sankey GT11"/>
<meta name="twitter:description" content="Nous allons ici nous pencher sur un type graphe unique (ou du moins présentant moins de différentes formes que ceux présentés jusqu’ici). Il permet de montrer à la fois comment les effectifs de différentes catégories se comparent entre eux dans un état et comment elles se transforment, se recombinent, pour former d’autres catégories dans un autre état voir plusieurs autres états. Il s’agit du diagramme de Sankey inventé par un ingénieur irlandais qui lui a donné son nom en 1898."/>
<meta name="twitter:site" content="@VigneronLudovic"/>

        
        <title>
  Le diagramme de Sankey GT11 | My Econ Tricks
</title>

        <link rel="icon" type="image/png" href='/images/favicon-16x16.png' sizes="16x16">
        <link rel="icon" type="image/png" href='/images/favicon-32x32.png' sizes="32x32">  

        <link href="https://fonts.googleapis.com/css?family=Oswald:400" rel="stylesheet">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">      
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
        
        
        
        

        <link rel="stylesheet" href="/css/bundle.min.3c1ab42be3f0635203d9e8bbe9cd3da817ca1d442ea586b8d8de6a4853e0d743.css" integrity="sha256-PBq0K&#43;PwY1ID2ei76c09qBfKHUQupYa42N5qSFPg10M="  />

        
    <link rel="me" type="text/html" href="https://twitter.com/VigneronLudovic"/> 
<link rel="me" type="text/html" href="https://www.linkedin.com/in/ludovic-vigneron-1ba27749/"/> 
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">

<link rel="alternate" type="application/rss+xml" href='/index.xml' />

<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="author" content="My Econ Tricks" />
<meta name="copyright" content="© Ludovic Vigneroin 2021–2022. All rights reserved." />
<meta name="google-site-verification" content="gvTIRAZF7KZCKm-syPBJcDj0JiQpJqR6f6uq6PCfZYs" />


<meta name="description" content="Nous allons ici nous pencher sur un type graphe unique (ou du moins présentant moins de différentes formes que ceux présentés jusqu’ici). Il permet de montrer à la fois comment les effectifs de différentes catégories se comparent entre eux dans un état et comment elles se transforment, se recombinent, pour former d’autres catégories dans un autre état voir plusieurs autres états. Il s’agit du diagramme de Sankey inventé par un ingénieur irlandais qui lui a donné son nom en 1898.">


    
        
    </head>
    <body>
        <nav class="navbar fixed-top navbar-expand-md navbar-dark bg-dark py-1 top-nav">
            <div class="container">
                    <a class="navbar-brand pr-2" href="/">MY ECON TRICKS</a>
                <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="navbar-collapse collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item">
    <a class="nav-link active" href="/about/">A propos</a>
</li>
<li class="nav-item">
    <a class="nav-link active" href="/categories/recherche/">Recherche</a>
</li>
<li class="nav-item">
    <a class="nav-link active" href="/categories/datavisualisation/">Datavisualisation</a>
</li>
<li class="nav-item">
    <a class="nav-link active" href="/categories/r/">R</a>
</li>

                    </ul>
                    <div class="social-icons d-none d-lg-block">
                        <a class="py-2 px-2" href="https://twitter.com/VigneronLudovic"><i class="fab fa-twitter"></i></a>
<a class="py-2 px-2" href="https://www.linkedin.com/in/ludovic-vigneron-1ba27749/"><i class="fab fa-linkedin"></i></a>
<a class="py-2 px-2" href='/index.xml'><i class="fas fa-rss"></i></a>

                    </div>
                </div>
            </div>
        </nav>

        
<header class="feature-image d-print-none">
</header>

        
        <div class="main">
            
<div class="container mt-4 post">
    <h1>Le diagramme de Sankey GT11</h1>
    <div class="mb-3">
    <small>
        <strong>By Ludovic Vigneron</strong>
        | <i class="far fa-calendar-alt"></i>&nbsp;May 10, 2022&nbsp;
        | <i class="fa fa-tags" title="Tags" aria-hidden="true"></i> <a href='/tags/dataviz/'>dataviz</a>, <a href='/tags/ggplot2/'>ggplot2</a>, <a href='/tags/r/'>r</a>
    </small>
</div>

    <div class="share-icons d-flex justify-content-center d-print-none">
        <a href="https://twitter.com/intent/tweet?url=%2fpost%2f2022-05-10-le-diagramme-de-sankey-gt11%2f&text=Le%20diagramme%20de%20Sankey%20GT11&tw_p=tweetbutton" class="p-2" title="Share on Twitter" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Tweet</small></div>
</a>

<a href="https://www.facebook.com/sharer.php?u=%2fpost%2f2022-05-10-le-diagramme-de-sankey-gt11%2f&t=Le%20diagramme%20de%20Sankey%20GT11" class="p-2" title="Share on Facebook" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-facebook fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Share</small></div>
</a>

<a href="https://www.linkedin.com/shareArticle?mini=true&url=%2fpost%2f2022-05-10-le-diagramme-de-sankey-gt11%2f&title=Le%20diagramme%20de%20Sankey%20GT11&source=mattbutton.com" class="p-2" title="Share on LinkedIn" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Share</small></div>
</a>

<a href="javascript:window.print()" title="Print this article" class="p-2" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fa fa-print fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Print</small></div>
</a>
    </div>

    <div class="mt-4 mb-4 main-content">
        


<p><strong>Nous allons ici nous pencher sur un type graphe unique (ou du moins présentant moins de différentes formes que ceux présentés jusqu’ici). Il permet de montrer à la fois comment les effectifs de différentes catégories se comparent entre eux dans un état et comment elles se transforment, se recombinent, pour former d’autres catégories dans un autre état voir plusieurs autres états. Il s’agit du diagramme de Sankey inventé par un ingénieur irlandais qui lui a donné son nom en 1898. Les transitions sont marquées par des flèches ou des bandes dont la largeurs reflètent l’importance des effectifs déplacés d’un état à l’autre. Le résultat illustre bien les relations en cascade entre variables qualitatives. La logique qui préside à l’ordre de présentation des états peut être soit chronologique, soit guider par les comparaisons qui vous voulez réaliser. Il y aura donc dans ce dernier cas une réflexion à mener afin que le message porté par le graphe corresponde en toute rigueur à celui que vous désirez transmettre. Il sera par ailleurs important de veiller à ce que le nombre de catégories par état ainsi que le nombre de croisements de lignes lors des transferts ne soient pas trop important pour que l’ensemble reste lisible.</strong></p>
<p>Illustrons cela à partir de quelques exemples composés à partir de ggplot et de ses dérivées. Nous utiliserons ici un package particulier ggsankey. Attention celui-ci (au moment où j’écris ce poste) n’est pas disponible sur le CRAN. Il faudra le charger à partir de github via devtools.</p>
<p>devtools::install_github(“davidsjoberg/ggsankey”)</p>
<p>Une fois celui-ci installé, on peut appeler les packages dans notre environnement de travail.</p>
<pre class="r"><code>library(tidyverse)
library(ggsankey)</code></pre>
<p>Avant d’utiliser un jeu de données réelles pour illustrer la construction d’un diagramme de Sankey, travaillons à partir d’éléments que l’on définit nous-même. Commençons donc par les établir. Considérons un système avec deux états nommés A et B. Au sein de l’état A, il y a trois catégories dont les effectifs se répartissent de la manière suivante: 20% de “chi”, 50% de “fou” et 30% de “mi”. Au sein de l’état B, il y a quatre catégories qui se répartissent comme suit: 10% de “tra”, 20% de “lala”, 40% de “la” et 30% de “lère”. On a donc:</p>
<pre class="r"><code>dat_sim&lt;-data.frame(Etat=c(rep(&#39;A&#39;,3),rep(&#39;B&#39;,4)),
                    cat=c(&#39;chi&#39;,&#39;fou&#39;,&#39;mi&#39;,&#39;tra&#39;,&#39;lala&#39;,&#39;la&#39;,&#39;lère&#39;),
                    eff=c(0.2,0.5,0.3,0.3,0.4,0.1,0.2))
dat_sim</code></pre>
<pre><code>##   Etat  cat eff
## 1    A  chi 0.2
## 2    A  fou 0.5
## 3    A   mi 0.3
## 4    B  tra 0.3
## 5    B lala 0.4
## 6    B   la 0.1
## 7    B lère 0.2</code></pre>
<p>L’ensemble peut être représenté par deux diagrammes à bâtons empilés mis en paralèlle.</p>
<pre class="r"><code>ggplot(data=dat_sim,
       aes(x=Etat,y=eff,fill=cat))+
  geom_bar(stat=&#39;identity&#39;,position = &#39;fill&#39;,width=0.5,colour=&#39;black&#39;)+
  geom_text(aes(label=cat,y=c(0.9,0.6,0.15,0.15,0.70,0.95,0.40)))+
  theme_minimal()+
  theme(axis.title= element_blank(),
        legend.position = &#39;none&#39;)</code></pre>
<p><img src="/post/2022-05-10-le-diagramme-de-sankey-gt11/index_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>La représentation est intéressante mais elle ne dit rien sur le passage des individus de l’état A à l’état B. Le diagramme de Sankey nous permet d’intégrer cette information à la représentation. Intégrons les éléments suivants. Sur une centaine d’individu au totale. Parmi ceux appartement à la catégorie “chi” dans l’état A, 10 passent à la catégorie “tra” dans l’état B, 5 à la catégorie “lala”, 5 à la catégorie “la”. Pour l’instant, considérons que les autres ne bougent pas.</p>
<pre class="r"><code>dat_sank1&lt;-data.frame(x=factor(c(rep(&#39;A&#39;,100),rep(&#39;B&#39;,100))),
                     node=c(rep(&#39;chi&#39;,20),rep(&#39;fou&#39;,50),rep(&#39;mi&#39;,30),
                            rep(&#39;tra&#39;,30),rep(&#39;lala&#39;,40),rep(&#39;la&#39;,10),
                            rep(&#39;lère&#39;,20)),
                     next_x=c(rep(2,20),rep(NA,180)),
                     next_node=c(rep(&#39;tra&#39;,10),rep(&#39;lala&#39;,5),rep(&#39;la&#39;,5),
                                 rep(NA,180)))</code></pre>
<p>Établissons un graphe de base à partir de là, en utilisant uniquement le <strong>geom_sankey()</strong> sans mise en forme.</p>
<pre class="r"><code>ggplot(dat_sank1, 
       aes(x = x, next_x = next_x, node = node, next_node = next_node,
           fill = factor(node))) +
  geom_sankey()</code></pre>
<p><img src="/post/2022-05-10-le-diagramme-de-sankey-gt11/index_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Le résultat est peu convainquant. Mais, il peut facilement être amélioré. Ajoutons de la transparence sur les flux et entourons les nœuds d’un liseré noir.</p>
<pre class="r"><code>ggplot(dat_sank1, 
       aes(x = x, next_x = next_x, node = node, next_node = next_node,
           fill = factor(node))) +
  geom_sankey(flow.alpha = 0.6,node.color = &quot;black&quot;)</code></pre>
<p><img src="/post/2022-05-10-le-diagramme-de-sankey-gt11/index_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Ajoutons des étiquettes pour le nom des nœuds en utilisant le <strong>geom_sankey_label()</strong> et un titre à l’ensemble. Passons aussi par un thème dédié (le <strong>theme_sankey()</strong>).</p>
<pre class="r"><code>ggplot(dat_sank1, 
       aes(x = x, next_x = next_x, node = node, next_node = next_node,
           fill = factor(node),label = node)) +
  geom_sankey(flow.alpha = 0.6,node.color = &quot;black&quot;)+
  geom_sankey_label(size = 3, color = &quot;white&quot;, fill = &quot;gray40&quot;) +
  labs(title=&#39;Transferts de chi&#39;)+
  theme_sankey(base_size = 18) +
  theme(plot.title = element_text(hjust=0.5),
        axis.title = element_blank(),
        legend.position = &#39;none&#39;)</code></pre>
<p><img src="/post/2022-05-10-le-diagramme-de-sankey-gt11/index_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Le résultat est bien plus convaincant. Voyons ce qu’il en est si on intègre le devenir des catégories ‘fou’ et ‘mi’. Ceux-ci se composent comme suit: sur les 50 ‘fou’, 20 deviennent ‘tra’, 10 ‘lala’, 5 ‘la’ et 15 ‘lère’; sur les 30 ‘mi’, 25 deviennent ‘lala’ et 5 ‘lère’.</p>
<pre class="r"><code>dat_sank&lt;-data.frame(x=factor(c(rep(&#39;A&#39;,100),rep(&#39;B&#39;,100))),
                     node=c(rep(&#39;chi&#39;,20),rep(&#39;fou&#39;,50),rep(&#39;mi&#39;,30),
                            rep(&#39;tra&#39;,30),rep(&#39;lala&#39;,40),rep(&#39;la&#39;,10),
                            rep(&#39;lère&#39;,20)),
                     next_x=c(rep(2,100),rep(NA,100)),
                     next_node=c(rep(&#39;tra&#39;,10),rep(&#39;lala&#39;,5),rep(&#39;la&#39;,5),
                                 rep(&#39;tra&#39;,20),rep(&#39;lala&#39;,10),rep(&#39;la&#39;,5),
                                 rep(&#39;lère&#39;,15),
                                 rep(&#39;lala&#39;,25),rep(&#39;lère&#39;,5),
                                 rep(NA,100)))
ggplot(dat_sank, 
       aes(x = x, next_x = next_x, node = node, next_node = next_node,
           fill = factor(node),label = node)) +
  geom_sankey(flow.alpha = 0.6,
              node.color = &quot;black&quot;)+
  geom_sankey_label(size = 3, color = &quot;white&quot;, fill = &quot;gray40&quot;) +
  labs(title=&#39;Devenir de chi, fou, mi&#39;)+
  theme_sankey(base_size = 18) +
  theme(plot.title = element_text(hjust=0.5),
        axis.title = element_blank(),
        legend.position = &#39;none&#39;)</code></pre>
<p><img src="/post/2022-05-10-le-diagramme-de-sankey-gt11/index_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Voyons maintenant comment faire de même à partir de données réelles. Reprenons les données d’admissions à Berkley pour l’automne 1973 que nous avions utilisées pour illustrer le diagramme en mosaïque et le paradoxe de Simpson. Celles-ci sont issues d’un tableau sur la page wikipédia (US) sur ce dernier. Nous les avons scrapper à l’aide du code suivant:</p>
<pre class="r"><code>library(rvest)</code></pre>
<pre><code>## 
## Attachement du package : &#39;rvest&#39;</code></pre>
<pre><code>## L&#39;objet suivant est masqué depuis &#39;package:readr&#39;:
## 
##     guess_encoding</code></pre>
<pre class="r"><code>url&lt;-&quot;https://en.wikipedia.org/wiki/Simpson%27s_paradox&quot;
dat&lt;-url %&gt;% 
    read_html() %&gt;%
    html_nodes(xpath=&#39;//*[@id=&quot;mw-content-text&quot;]/div[1]/table[2]&#39;) %&gt;%
    html_table() %&gt;% 
    as.data.frame()</code></pre>
<p>Puis, nous avons établi une data frame correspondant à ces informations établis au niveau individuel.</p>
<pre class="r"><code>dat2&lt;-data.frame(sexe=c(rep(&#39;homme&#39;,2691),rep(&#39;femme&#39;,1835)),
                 dep=c(rep(&#39;A&#39;,825),rep(&#39;B&#39;,560),rep(&#39;C&#39;,325),
                       rep(&#39;D&#39;,417),rep(&#39;E&#39;,191),rep(&#39;F&#39;,373),
                       rep(&#39;A&#39;,108),rep(&#39;B&#39;,25),rep(&#39;C&#39;,593),
                       rep(&#39;D&#39;,375),rep(&#39;E&#39;,393),rep(&#39;F&#39;,341)),
                 statut=c(rep(&#39;admis&#39;,round(825*0.62)-1),rep(&#39;rejeté&#39;,round(825*0.38)),
                       rep(&#39;admis&#39;,round(560*0.63)),rep(&#39;rejeté&#39;,round(560*0.37)),
                       rep(&#39;admis&#39;,round(325*0.37)),rep(&#39;rejeté&#39;,round(325*0.63)),
                       rep(&#39;admis&#39;,round(417*0.33)),rep(&#39;rejeté&#39;,round(417*0.67)),
                       rep(&#39;admis&#39;,round(191*0.28)),rep(&#39;rejeté&#39;,round(191*0.72)),
                       rep(&#39;admis&#39;,round(373*0.06)),rep(&#39;rejeté&#39;,round(373*0.94)),
                       rep(&#39;admis&#39;,round(108*0.82)),rep(&#39;rejeté&#39;,round(108*0.18)),
                       rep(&#39;admis&#39;,round(25*0.68)),rep(&#39;rejeté&#39;,round(25*0.32)),
                       rep(&#39;admis&#39;,round(593*0.34)),rep(&#39;rejeté&#39;,round(593*0.66)),
                       rep(&#39;admis&#39;,round(375*0.35)),rep(&#39;rejeté&#39;,round(375*0.65)),
                       rep(&#39;admis&#39;,round(393*0.24)),rep(&#39;rejeté&#39;,round(393*0.76)),
                       rep(&#39;admis&#39;,round(341*0.07)),rep(&#39;rejeté&#39;,round(341*0.93))))
glimpse(dat2)</code></pre>
<pre><code>## Rows: 4,526
## Columns: 3
## $ sexe   &lt;chr&gt; &quot;homme&quot;, &quot;homme&quot;, &quot;homme&quot;, &quot;homme&quot;, &quot;homme&quot;, &quot;homme&quot;, &quot;homme&quot;, ~
## $ dep    &lt;chr&gt; &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;~
## $ statut &lt;chr&gt; &quot;admis&quot;, &quot;admis&quot;, &quot;admis&quot;, &quot;admis&quot;, &quot;admis&quot;, &quot;admis&quot;, &quot;admis&quot;, ~</code></pre>
<p>Les données articulées de la sorte ne permettent pas de réaliser directement un diagramme de Sankey. Le package prévoit une fonction pour réaliser les transformations nécessaires sans efforts. Il s’agit de <strong>make_long()</strong> dans la laquelle on indique le nom de la data frame et celui des variables à re-coder en suivant l’ordre des états qu’elles marquent. Choisissons ici pour commencer de mettre la variable sexe au milieu.</p>
<pre class="r"><code>dat_l&lt;-make_long(dat2,dep,sexe,statut)</code></pre>
<p>Cela permet de bien voir comment cette éléments impactes les deux autres, autrement-dit comment les candidatures dans les différents départements se répartissent en fonction du sexe des individus et comment la réussite ou l’échec des candidatures se répartissent en fonction du sexe.</p>
<pre class="r"><code>ggplot(dat_l, 
       aes(x = x, next_x = next_x, node = node, next_node = next_node,
           fill = factor(node),label = node)) +
  geom_sankey(flow.alpha = 0.6,
              node.color = &quot;black&quot;)+
  geom_sankey_label(size = 3, color = &quot;white&quot;, fill = &quot;gray40&quot;) +
  labs(title=&#39;Admissions à Berkley 1973&#39;,
       caption=&quot;Source: wikipedia US - Simpson&#39;s paradox&quot;)+
  theme_sankey(base_size = 18) +
  theme(plot.title = element_text(hjust=0.5),
        plot.caption = element_text(hjust=1,size=6,face=&#39;italic&#39;),
        axis.title = element_blank(),
        legend.position = &#39;none&#39;)</code></pre>
<p><img src="/post/2022-05-10-le-diagramme-de-sankey-gt11/index_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>On voit que certains département attirent plus de femmes que d’homme et que globalement elles sont en proportion plus souvent rejetées. Cela pourrait être le fruit d’un traitement inégalitaire. Néanmoins, les choses sont plus compliquées. Les femmes sont plus nombreuses à postuler dans les départements les plus sélectifs. Le problème est donc plus structurelle. Les choses sont plus claires si on place la variable sexe en premier.</p>
<pre class="r"><code>dat_l2&lt;-make_long(dat2,sexe,dep,statut)</code></pre>
<p>Le diagramme est alors plus parlant.</p>
<pre class="r"><code>ggplot(dat_l2, 
       aes(x = x, next_x = next_x, node = node, next_node = next_node,
           fill = factor(node),label = node)) +
  geom_sankey(flow.alpha = 0.6,
              node.color = &quot;black&quot;)+
  geom_sankey_label(size = 3, color = &quot;white&quot;, fill = &quot;gray40&quot;) +
  labs(title=&#39;Admissions à Berkley 1973&#39;,
       caption=&quot;Source: wikipedia US - Simpson&#39;s paradox&quot;)+
  theme_sankey(base_size = 18) +
  theme(plot.title = element_text(hjust=0.5),
        plot.caption = element_text(hjust=1,size=6,face=&#39;italic&#39;),
        axis.title = element_blank(),
        legend.position = &#39;none&#39;)</code></pre>
<p><img src="/post/2022-05-10-le-diagramme-de-sankey-gt11/index_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>On voit clairement que les femmes s’orientent principalement sur les départements les plus sélectifs et donc sont plus fréquemment rejetées que les hommes.</p>
<p>Il y a bien d’autres manières de réaliser un diagramme de Sankey en mobilisant d’autres packages (comme plotly, networkd3,PantaRhei) ou d’autres logiciels (Tableau, Python, Java, même Excel…), certains sites permettent de le faire en ligne (comme (Sankeymatic)[<a href="https://sankeymatic.com/build/" class="uri">https://sankeymatic.com/build/</a>]). Nous reviendrons dessus avec des applications plus variées. Ce type de diagramme marquant les liens entre variables qualitatives me donne pas mal d’idées.</p>


        <div class="share-icons d-flex justify-content-center d-print-none">
            <a href="https://twitter.com/intent/tweet?url=%2fpost%2f2022-05-10-le-diagramme-de-sankey-gt11%2f&text=Le%20diagramme%20de%20Sankey%20GT11&tw_p=tweetbutton" class="p-2" title="Share on Twitter" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Tweet</small></div>
</a>

<a href="https://www.facebook.com/sharer.php?u=%2fpost%2f2022-05-10-le-diagramme-de-sankey-gt11%2f&t=Le%20diagramme%20de%20Sankey%20GT11" class="p-2" title="Share on Facebook" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-facebook fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Share</small></div>
</a>

<a href="https://www.linkedin.com/shareArticle?mini=true&url=%2fpost%2f2022-05-10-le-diagramme-de-sankey-gt11%2f&title=Le%20diagramme%20de%20Sankey%20GT11&source=mattbutton.com" class="p-2" title="Share on LinkedIn" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Share</small></div>
</a>

<a href="javascript:window.print()" title="Print this article" class="p-2" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fa fa-print fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Print</small></div>
</a>
        </div>
    </div>

    
</div>
<div class="sidebar d-print-none d-none d-xl-block">
    
        <h2>My Econ Tricks</h2>
        <div>
            Blog académique tenu par Ludovic Vigneron, docteur en Finance et, depuis un certain nombre d&#39;années, Maître de Conférences à l&#39;Université Polytechnique Hauts de France.
        </div>
        <a href='/about/' class="btn btn-outline-secondary mt-3" role="button">Read More...</a>
        <h2 class="mt-4">Top Posts</h2>
    
    
    <h2 class="mt-4">Posts recents</h2>
    <nav class="nav flex-column">
        
        <a href="/post/2022-05-26-ttrer/" class="nav-link">ttrer</a>
        
        <a href="/post/2022-05-23-le-diagramme-en-chute-d-eau-gt12/" class="nav-link">Le diagramme en chute d&#39;eau GT12</a>
        
        <a href="/post/2022-05-10-le-diagramme-de-sankey-gt11/" class="nav-link">Le diagramme de Sankey GT11</a>
        
        <a href="/post/2022-05-05-bulles-de-comparaison-et-bulle-intriqu-e-gt10/" class="nav-link">Bulles de comparaison et bulle intriquée GT10</a>
        
        <a href="/post/2022-04-17-bullet-chart-et-gauge-chart-gt-9/" class="nav-link">Bullet chart et gauge chart GT9</a>
        
        <a href="/post/2022-04-10-test/" class="nav-link">Les heatmap et les calendar heatmap GT8</a>
        
        <a href="/post/2022-03-25-mes-premieres-videos-de-codage-de-graphes/" class="nav-link">Mes premieres videos de codage de graphes</a>
        
        <a href="/post/2022-04-29-les-diagramme-en-gaufre-et-les-isotypes-gt7/" class="nav-link">Les diagrammes en gaufre et les isotypes GT7</a>
        
    </nav>
    
    <h2 class="mt-4 text-capitalize">categories</h2>
    <nav class="nav flex-column">
        
        <a href='/categories/datavisualisation/' class="nav-link">
        datavisualisation
        <span class="badge badge-pill badge-secondary">19</span>
        </a>
        
        <a href='/categories/r/' class="nav-link">
        r
        <span class="badge badge-pill badge-secondary">16</span>
        </a>
        
        <a href='/categories/ggplot2/' class="nav-link">
        ggplot2
        <span class="badge badge-pill badge-secondary">6</span>
        </a>
        
        <a href='/categories/dataviz/' class="nav-link">
        dataviz
        <span class="badge badge-pill badge-secondary">2</span>
        </a>
        
        <a href='/categories/analysis/' class="nav-link">
        analysis
        <span class="badge badge-pill badge-secondary">1</span>
        </a>
        
        <a href='/categories/mathematique/' class="nav-link">
        mathematique
        <span class="badge badge-pill badge-secondary">1</span>
        </a>
        
        <a href='/categories/recherche/' class="nav-link">
        recherche
        <span class="badge badge-pill badge-secondary">1</span>
        </a>
        
        <a href='/categories/software-development/' class="nav-link">
        software-development
        <span class="badge badge-pill badge-secondary">1</span>
        </a>
        
    </nav>
    
    <h2 class="mt-4 text-capitalize">tags</h2>
    <nav class="nav flex-column">
        
        <a href='/tags/dataviz/' class="nav-link">
        dataviz
        <span class="badge badge-pill badge-secondary">19</span>
        </a>
        
        <a href='/tags/ggplot2/' class="nav-link">
        ggplot2
        <span class="badge badge-pill badge-secondary">17</span>
        </a>
        
        <a href='/tags/r/' class="nav-link">
        r
        <span class="badge badge-pill badge-secondary">11</span>
        </a>
        
        <a href='/tags/climat/' class="nav-link">
        climat
        <span class="badge badge-pill badge-secondary">3</span>
        </a>
        
        <a href='/tags/analysis/' class="nav-link">
        analysis
        <span class="badge badge-pill badge-secondary">1</span>
        </a>
        
        <a href='/tags/crowdfunding/' class="nav-link">
        crowdfunding
        <span class="badge badge-pill badge-secondary">1</span>
        </a>
        
        <a href='/tags/exercice/' class="nav-link">
        exercice
        <span class="badge badge-pill badge-secondary">1</span>
        </a>
        
        <a href='/tags/mathematic/' class="nav-link">
        mathematic
        <span class="badge badge-pill badge-secondary">1</span>
        </a>
        
        <a href='/tags/plotly/' class="nav-link">
        plotly
        <span class="badge badge-pill badge-secondary">1</span>
        </a>
        
        <a href='/tags/publication/' class="nav-link">
        publication
        <span class="badge badge-pill badge-secondary">1</span>
        </a>
        
    </nav>
    
</div>

        </div>

        <footer class="mt-auto footer d-print-none">
            <div class="container-fluid">
                <div class="row justify-content-center">
                    <div class="col-md-4 col-xl-3">
                        <h5>© Ludovic Vigneroin 2021–2022. All rights reserved.</h5>
Content on this site is licensed under a Creative Commons Attribution 4.0 International license.
                    </div>
                    <div class="col-md-4 col-xl-3">
                        <h5>Disclaimer</h5>
Opinions expressed here are my own and may not reflect those of the company I work for, or the people I work with.
                    </div>
                    <div class="col-md-4 col-xl-3">
                        <h5>About This Site</h5>
This blog was created using the <a href="https://gohugo.io/">Hugo</a> static site generator, using
<a href="https://getbootstrap.com/">Bootstrap</a>, using the Silhouette Hugo theme, created by
<a href='https://www.mattbutton.com'>Matt Button</a>


    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    
                    </div>
                </div>

                <hr />

                <div class="d-flex justify-content-center icons">
                    <a class="py-2 px-2" href="https://twitter.com/VigneronLudovic"><i class="fab fa-twitter"></i></a>
<a class="py-2 px-2" href="https://www.linkedin.com/in/ludovic-vigneron-1ba27749/"><i class="fab fa-linkedin"></i></a>
<a class="py-2 px-2" href='/index.xml'><i class="fas fa-rss"></i></a>

                </div>
            </div>
        </footer>

        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

        
    </body>
</html>
